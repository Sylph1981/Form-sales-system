"""Subclass of MyFrame2, which is generated by wxFormBuilder."""

import wx
import app
import json
import codecs
import wx.grid
import gspread

#ServiceAccountCredentials：Googleの各サービスへアクセスできるservice変数を生成します。
from oauth2client.service_account import ServiceAccountCredentials

import time
import re
from bs4 import BeautifulSoup
from tqdm import tqdm

#2つのAPIを記述しないとリフレッシュトークンを3600秒毎に発行し続けなければならない
scope = ['https://spreadsheets.google.com/feeds','https://www.googleapis.com/auth/drive']

#ドラッグアンドドロップの実装
class FileDropTarget1(wx.FileDropTarget):
    def __init__(self, window):
        wx.FileDropTarget.__init__(self)
        self.window = window

    def OnDropFiles(self, x, y, files):
        self.window.m_textCtrl11.SetLabel(files[0])
        return 0

class FileDropTarget2(wx.FileDropTarget):
    def __init__(self, window):
        wx.FileDropTarget.__init__(self)
        self.window = window

    def OnDropFiles(self, x, y, files):
        self.window.m_textCtrl111.SetLabel(files[0])
        return 0
    
# Implementing MyFrame2
class MyProject1MyFrame2( app.MyFrame2 ):
	def __init__( self, parent ):
		app.MyFrame2.__init__( self, parent )
 
#Setting up the menu on menubar.
		self.m_menubar1 = wx.MenuBar( 0 )
		self.m_menu1 = wx.Menu()
		self.m_menuItem1 = wx.MenuItem( self.m_menu1, wx.ID_ANY, u"MyMenuItem", wx.EmptyString, wx.ITEM_NORMAL )
		self.m_menu1.Append( self.m_menuItem1 )

		self.m_menuItem2 = wx.MenuItem( self.m_menu1, wx.ID_ANY, u"Exit", wx.EmptyString, wx.ITEM_NORMAL )
		self.m_menu1.Append( self.m_menuItem2 )

		self.m_menubar1.Append( self.m_menu1, u"File" )

		self.m_menu11 = wx.Menu()
		self.m_menuItem11 = wx.MenuItem( self.m_menu11, wx.ID_ANY, u"Configuration", wx.EmptyString, wx.ITEM_NORMAL )
		self.m_menu11.Append( self.m_menuItem11 )

		self.m_menuItem12 = wx.MenuItem( self.m_menu11, wx.ID_ANY, u"Profile", wx.EmptyString, wx.ITEM_NORMAL )
		self.m_menu11.Append( self.m_menuItem12 )

		self.m_menuItem13 = wx.MenuItem( self.m_menu11, wx.ID_ANY, u"Send text creation", wx.EmptyString, wx.ITEM_NORMAL )
		self.m_menu11.Append( self.m_menuItem13 )

		self.m_menubar1.Append( self.m_menu11, u"Setting" )

		self.m_menu111 = wx.Menu()
		self.m_menuItem111 = wx.MenuItem( self.m_menu111, wx.ID_ANY, u"Create", wx.EmptyString, wx.ITEM_NORMAL )
		self.m_menu111.Append( self.m_menuItem111 )

		self.m_menuItem211 = wx.MenuItem( self.m_menu111, wx.ID_ANY, u"Inquiry", wx.EmptyString, wx.ITEM_NORMAL )
		self.m_menu111.Append( self.m_menuItem211 )

		self.m_menubar1.Append( self.m_menu111, u"List" )

		self.SetMenuBar( self.m_menubar1 )

#Connect Events
		self.Bind( wx.EVT_MENU, self.quit_button, self.m_menuItem2 )
		self.Bind( wx.EVT_MENU, self.Configuration, self.m_menuItem11 )
		self.Bind( wx.EVT_MENU, self.Profile, self.m_menuItem12 )
		self.Bind( wx.EVT_MENU, self.Send_email_body, self.m_menuItem13 )
		self.Bind( wx.EVT_MENU, self.create_button, self.m_menuItem111 )
		self.Bind( wx.EVT_MENU, self.inquiry_button, self.m_menuItem211 )
		self.Bind(wx.EVT_CLOSE, self.quit_button) 
        
#各メニュー項目選択後の画面遷移
	def Configuration(self, event):
	    adid = MyProject1MyDialog3(self)
	    adid.ShowModal()
	    adid.Destroy()

	def Profile(self, event):
	    adid = MyProject1MyDialog4(self)
	    adid.ShowModal()
	    adid.Destroy()

	def Send_email_body(self, event):
	    adid = MyProject1MyDialog5(self)
	    adid.ShowModal()
	    adid.Destroy()

	def inquiry_button(self, event):
	   adid = MyProject1MyDialog3(self)
        
	   if not adid.m_comboBox6.GetValue() == '1BazsXmS9dW8oAOmvjMNVabvvw1dYAgW9SR-qbyAylEU' \
           or not 'json' in adid.m_textCtrl11.GetValue():
	      adid.m_comboBox6.SetBackgroundColour('#f56cbe')
	      adid.m_textCtrl11.SetBackgroundColour('#f56cbe')
#	      self.m_textCtrl111.SetForegroundColour('#f56cbe')
	      wx.MessageBox(u'The key is incorrect or does not exist!!', u'Setting value error', wx.ICON_ERROR)
	   elif not 'chromedriver.exe' in adid.m_textCtrl111.GetValue():
	      adid.m_textCtrl111.SetForegroundColour('#f56cbe')
	      wx.MessageBox(u'The web driver file is not set or the file path does not pass!!', u'Setting value error', wx.ICON_ERROR)
	   elif adid.m_comboBox6.GetValue() == '1BazsXmS9dW8oAOmvjMNVabvvw1dYAgW9SR-qbyAylEU' \
           and 'json' in adid.m_textCtrl11.GetValue() \
               and 'chromedriver.exe' in adid.m_textCtrl111.GetValue():
	      adid.m_comboBox6.SetBackgroundColour('#FFFFFF')
	      adid.m_textCtrl11.SetBackgroundColour('#FFFFFF')
	      adid.m_textCtrl111.SetBackgroundColour('#FFFFFF')

	      sbSizer5 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel6, wx.ID_ANY, u"Processing related to inquiry form" ), wx.VERTICAL )

	      bSizer15 = wx.BoxSizer( wx.VERTICAL )

	      gSizer8 = wx.GridSizer( 0, 2, 0, 0 )

	      self.m_panel27 = wx.Panel( sbSizer5.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
	      self.m_panel27.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

	      sbSizer20 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel27, wx.ID_ANY, u"Extraction of inquiry page." ), wx.VERTICAL )

	      self.m_panel5 = wx.Panel( sbSizer20.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
	      bSizer16 = wx.BoxSizer( wx.VERTICAL )

	      gSizer5 = wx.GridSizer( 0, 2, 0, 0 )
        
#	      self.m_panel17 = wx.Panel( self.m_panel5, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
#	      self.m_panel17.SetFont( wx.Font( 10, wx.FONTFAMILY_MODERN, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

#	      sbSizer15 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel17, wx.ID_ANY, u"Worksheet title" ), wx.VERTICAL )

	      self.m_staticText5 = wx.StaticText( self.m_panel5, wx.ID_ANY, u"start", wx.DefaultPosition, wx.DefaultSize, 0 )
	      self.m_staticText5.Wrap( -1 )

	      self.m_staticText5.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

	      gSizer5.Add( self.m_staticText5, 0, wx.ALL|wx.ALIGN_RIGHT, 5 )

	      self.row1 = wx.SpinCtrl( self.m_panel5, wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 100,-1 ), wx.SP_ARROW_KEYS, 0, 1000, 0 )
	      gSizer5.Add( self.row1, 0, wx.ALL, 5 )
#	      self.row1.Disable()

	      self.m_staticText6 = wx.StaticText( self.m_panel5, wx.ID_ANY, u"last", wx.DefaultPosition, wx.DefaultSize, 0 )
	      self.m_staticText6.Wrap( -1 )

	      gSizer5.Add( self.m_staticText6, 0, wx.ALL|wx.ALIGN_RIGHT, 5 )

	      self.row2 = wx.SpinCtrl( self.m_panel5, wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 100,-1 ), wx.SP_ARROW_KEYS, 0, 1000, 0 )
	      gSizer5.Add( self.row2, 0, wx.ALL, 5 )
#	      self.row2.Disable()

	      self.m_staticText61 = wx.StaticText( self.m_panel5, wx.ID_ANY, u"sheet title", wx.DefaultPosition, wx.DefaultSize, 0 )
	      self.m_staticText61.Wrap( -1 )

	      gSizer5.Add( self.m_staticText61, 0, wx.ALL|wx.ALIGN_RIGHT, 5 )

#秘密鍵（JSONファイル）のファイル名を入力
	      credentials = ServiceAccountCredentials.from_json_keyfile_name(adid.m_textCtrl11.GetValue(), scope)

#OAuth2の資格情報を使用してGoogle APIにログインします。
	      gc = gspread.authorize(credentials)

#存在するワークシートの情報を全て取得
	      wb = gc.open_by_key(adid.m_comboBox6.GetValue())
	      worksheets = wb.worksheets()
        
#現在のワークシートのタイトルをリストへ格納
	      m_comboBox1Choices = [worksheet.title for worksheet in worksheets]
#	      print(m_comboBox1Choices)
	      self.m_comboBox1 = wx.ComboBox( self.m_panel5, wx.ID_ANY, u"選択して下さい", wx.DefaultPosition, wx.DefaultSize, m_comboBox1Choices, wx.CB_DROPDOWN )
        
	      gSizer5.Add( self.m_comboBox1, 0, wx.ALL, 5 )

#（お問い合わせページの抽出：機能未完成によりドロップボックスを無効）        
#	      self.m_comboBox1.Enable(False)
	      self.m_comboBox1.Enable(True)

	      self.btn3 = wx.Button( self.m_panel5, wx.ID_ANY, u"Check", wx.DefaultPosition, wx.DefaultSize, 0 )
	      self.btn3.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )
#	      self.btn3.Disable()
          
	      gSizer5.Add( self.btn3, 0, wx.ALL, 5 )

	      gSizer6 = wx.GridSizer( 0, 2, 0, 0 )


	      gSizer5.Add( gSizer6, 1, wx.EXPAND, 5 )


	      bSizer16.Add( gSizer5, 1, wx.EXPAND, 5 )


	      self.m_panel5.SetSizer( bSizer16 )
	      self.m_panel5.Layout()
	      bSizer16.Fit( self.m_panel5 )
	      sbSizer20.Add( self.m_panel5, 1, wx.EXPAND |wx.ALL, 5 )


	      self.m_panel27.SetSizer( sbSizer20 )
	      self.m_panel27.Layout()
	      sbSizer20.Fit( self.m_panel27 )
	      gSizer8.Add( self.m_panel27, 1, wx.EXPAND |wx.ALL, 5 )

	      self.m_panel271 = wx.Panel( sbSizer5.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
	      self.m_panel271.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

	      sbSizer201 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel271, wx.ID_ANY, u"Automatic form posting settings." ), wx.VERTICAL )

	      self.m_panel51 = wx.Panel( sbSizer201.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
	      bSizer161 = wx.BoxSizer( wx.VERTICAL )

	      gSizer51 = wx.GridSizer( 0, 2, 0, 0 )

	      self.m_staticText51 = wx.StaticText( self.m_panel51, wx.ID_ANY, u"start", wx.DefaultPosition, wx.DefaultSize, 0 )
	      self.m_staticText51.Wrap( -1 )

	      self.m_staticText51.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

	      gSizer51.Add( self.m_staticText51, 0, wx.ALL|wx.ALIGN_RIGHT, 5 )

	      self.row11 = wx.SpinCtrl( self.m_panel51, wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 100,-1 ), wx.SP_ARROW_KEYS, 0, 1000, 0 )
	      gSizer51.Add( self.row11, 0, wx.ALL, 5 )
	      self.row11.Disable()
          
	      self.m_staticText62 = wx.StaticText( self.m_panel51, wx.ID_ANY, u"last", wx.DefaultPosition, wx.DefaultSize, 0 )
	      self.m_staticText62.Wrap( -1 )

	      gSizer51.Add( self.m_staticText62, 0, wx.ALL|wx.ALIGN_RIGHT, 5 )

	      self.row21 = wx.SpinCtrl( self.m_panel51, wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 100,-1 ), wx.SP_ARROW_KEYS, 0, 1000, 0 )
	      gSizer51.Add( self.row21, 0, wx.ALL, 5 )
	      self.row21.Disable()
          
	      self.m_staticText611 = wx.StaticText( self.m_panel51, wx.ID_ANY, u"sheet title", wx.DefaultPosition, wx.DefaultSize, 0 )
	      self.m_staticText611.Wrap( -1 )

	      gSizer51.Add( self.m_staticText611, 0, wx.ALL|wx.ALIGN_RIGHT, 5 )

	      m_comboBox11Choices = [worksheet.title for worksheet in worksheets]
	      self.m_comboBox11 = wx.ComboBox( self.m_panel51, wx.ID_ANY, u"選択して下さい", wx.DefaultPosition, wx.DefaultSize, m_comboBox11Choices, wx.CB_DROPDOWN )
#	      print(m_comboBox1Choices)

	      gSizer51.Add( self.m_comboBox11, 0, wx.ALL, 5 )

#（お問い合わせページの抽出：機能未完成によりドロップボックスを無効）        
	      self.m_comboBox11.Enable(False)
#	      self.m_comboBox11.Enable(True)

	      self.btn31 = wx.Button( self.m_panel51, wx.ID_ANY, u"Create", wx.DefaultPosition, wx.DefaultSize, 0 )
	      self.btn31.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )
	      self.btn31.Disable()
          
	      gSizer51.Add( self.btn31, 0, wx.ALL, 5 )

	      gSizer61 = wx.GridSizer( 0, 2, 0, 0 )


	      gSizer51.Add( gSizer61, 1, wx.EXPAND, 5 )


	      bSizer161.Add( gSizer51, 1, wx.EXPAND, 5 )


	      self.m_panel51.SetSizer( bSizer161 )
	      self.m_panel51.Layout()
	      bSizer161.Fit( self.m_panel51 )
	      sbSizer201.Add( self.m_panel51, 1, wx.EXPAND |wx.ALL, 5 )


	      self.m_panel271.SetSizer( sbSizer201 )
	      self.m_panel271.Layout()
	      sbSizer201.Fit( self.m_panel271 )
	      gSizer8.Add( self.m_panel271, 1, wx.EXPAND |wx.ALL, 5 )


	      bSizer15.Add( gSizer8, 1, wx.EXPAND, 5 )

	      sbSizer5.Add( bSizer15, 1, wx.EXPAND, 5 )


	      self.m_panel6.SetSizer( sbSizer5 )
	      self.m_panel6.Layout()
	      sbSizer5.Fit( self.m_panel6 )

# Connect Events
	      self.btn3.Bind( wx.EVT_BUTTON, self.inquiry_url )
	      self.btn31.Bind( wx.EVT_BUTTON, self.inquiry_post )

        
	# Handlers for MyFrame2 events.
	def create_button( self, event ):
	   adid = MyProject1MyDialog3(self)
	   if not adid.m_comboBox6.GetValue() == '1BazsXmS9dW8oAOmvjMNVabvvw1dYAgW9SR-qbyAylEU' \
           or adid.m_textCtrl11.GetValue() == '1BazsXmS9dW8oAOmvjMNVabvvw1dYAgW9SR-qbyAylEU' \
               or not 'json' in adid.m_textCtrl11.GetValue() \
                   or not 'chromedriver.exe' in adid.m_textCtrl111.GetValue():
	      wx.MessageBox(u'The key is incorrect or does not exist!!', u'Setting value error', wx.ICON_ERROR)
	   elif not 'chromedriver.exe' in adid.m_textCtrl111.GetValue():
	      wx.MessageBox(u'The web driver file is not set or the file path does not pass!!', u'Setting value error', wx.ICON_ERROR)          
	   else:
#MyFrame2のテキストボックス及びコンボボックスの値をMyDialogに受け渡し
	    adid = MyProject1MyDialog(self)
	    adid.ShowModal()
	    adid.Destroy()
	def quit_button( self, event ):
		# TODO: Implement quit_button
		self.Destroy()
        
	def inquiry_url( self, event ):
		adid = MyProject1MyDialog3(self)
		credentials = ServiceAccountCredentials.from_json_keyfile_name(adid.m_textCtrl11.GetValue(), scope)
		gc = gspread.authorize(credentials)                   
		row1 = self.row1.GetValue()
		row2 = self.row2.GetValue()

		if self.m_comboBox1.GetValue() == '選択して下さい':
		 self.m_comboBox1.SetBackgroundColour("#f56cbe")
		 wx.MessageBox(u'Please select the Worksheet title!!', u'Setting value error', wx.ICON_ERROR)
		elif row1 == 0 and row2 == 0:
		 self.row1.SetBackgroundColour('#f56cbe')
		 self.row2.SetBackgroundColour('#f56cbe')
		 self.m_comboBox1.SetBackgroundColour("#FFFFFF")
		 wx.MessageBox(u'Please set the range!!', u'Setting value error', wx.ICON_ERROR)
		elif row2 - row1 > 10000:
		 self.row1.SetBackgroundColour('#f56cbe')
		 self.row2.SetBackgroundColour('#f56cbe')
		 self.m_comboBox1.SetBackgroundColour("#FFFFFF")
		 wx.MessageBox(u'The value exceeds the configurable range!!', u'Setting value error', wx.ICON_ERROR)
		elif row2 - row1 < 0:
		 self.row1.SetBackgroundColour('#f56cbe')
		 self.row2.SetBackgroundColour('#f56cbe')
		 self.m_comboBox1.SetBackgroundColour("#FFFFFF")
		 wx.MessageBox(u'Illegal range!!', u'Setting value error', wx.ICON_ERROR)
		# Set cell values.
		else:
		 from selenium import webdriver
		 from selenium.webdriver.chrome.options import Options

#例外処理用のlibraryをimport
		 from selenium.common.exceptions import NoSuchElementException
		 from selenium.common.exceptions import WebDriverException
		 from selenium.common.exceptions import TimeoutException

#Selectモジュールをインポート
		 #from selenium.webdriver.support.select import Select

#オプションの作成
		 option = Options()

#起動オプション
# ヘッドレスモードを有効にする（次の行をコメントアウトすると画面が表示される）。
		 option.add_argument('--headless')

#「unknown error: net::ERR_CONNECTION_CLOSED」の回避用
		 option.add_argument('--disable-dev-shm-usage')

# ChromeのWebDriverオブジェクトを作成する。
		 driver = webdriver.Chrome(adid.m_textCtrl111.GetValue(),options=option)
		 driver.set_page_load_timeout(60)
		 wb = gc.open_by_key(adid.m_comboBox6.GetValue())            
		 ws3 = wb.worksheet(self.m_comboBox1.GetValue())
		 self.row1.SetBackgroundColour('#FFFFFF')
		 self.row2.SetBackgroundColour('#FFFFFF')
		 self.m_comboBox1.SetBackgroundColour("#FFFFFF")
		 adid = MyProject1MyFrame5(self)
		 adid.grid.ClearGrid()
#		 self.m_gauge2.SetValue( 0 )
#		 self.m_gauge2.SetRange(row2-row1)
         
		 dlg = wx.ProgressDialog(
            title="お問い合わせページ抽出中",
            message="0/100",
            maximum=100,
            style=wx.PD_AUTO_HIDE | wx.PD_ELAPSED_TIME | wx.PD_ESTIMATED_TIME | wx.PD_REMAINING_TIME )         
         
# ダイアログ表示
		 dlg.Show()
		 rate = 0

#所要時間計測開始
		 start = time.time()
    
#お問い合わせページのリンク
#		 lastrow1 = len(ws3.col_values(1))
		 for k in tqdm(range(row1, row2+1)):
		    if not ws3.cell(k, 5).value == "-" \
                or not ws3.cell(k, 5).value == "":
		     try:
		      driver.get(ws3.cell(k, 5).value)
		      time.sleep(2)

		      if 'Error 502 (Server Error)!!1' in driver.title:
		        ws3.update_cell(k, 6, driver.title)		 		 		  
		        continue
		      elif 'Not Found' in driver.title:
		        ws3.update_cell(k, 6, driver.title)		 		 		  
		        continue   
		      elif 'エラー' in driver.title:
		        ws3.update_cell(k, 6, driver.title)
		        continue

		      html = driver.page_source  
#   print(res.status_code)
		      soup = BeautifulSoup(html, 'html.parser')
#		      print(soup)

#エラー発生時に回避（①～⑤は実施されない）
		     except TimeoutException:
		      print("Time out!!")   
		      ws3.update_cell(k, 6, "Time out!!")
		      continue

		     except WebDriverException:
		      print("unknown error!!")   
		      ws3.update_cell(k, 6, "unknown error!!")
		      continue   

#抽出開始
		     if not "このサイトにアクセスできません" in html:
		      links_1 = []
		      for link in soup.select('a[href]'):
#		       print(soup.find_all('a'))
		       if "contact" in str(link.get("href")) \
                   and not "actover" in str(link.get("href")) \
                       and not "projection" in str(link.get("href")) \
                           and not "consultation" in str(link.get("href")) \
                               and not "regist" in str(link.get("href")) \
                                   and not "research" in str(link.get("href")) \
                                       and not "mailto" in str(link.get("href")) \
                                           and not "privacy" in str(link.get("href")) \
                                               and not "service" in str(link.get("href")) \
                                                   and not "recruit" in str(link.get("href")) \
                                                       and not "sdgs" in str(link.get("href")) \
                                                           and not "magazine" in str(link.get("href")) \
                   or "form2" in str(link.get("href")) \
                       and "inq" in str(link.get("href")) \
                   or "contact" in str(link.get("href")) \
                       and "salesmarketingservice" in str(link.get("href")) \
		     	   or r"contact/inq" in str(link.get("href")) \
		     	   or "CONTACT" in str(link.get("href")) \
                        and not "mailto" in str(link.get("href")) \
                            and not "privacy" in str(link.get("href")) \
                                and not "service" in str(link.get("href")) \
                                    and not "recruit" in str(link.get("href")) \
                                        and not "sdgs" in str(link.get("href")) \
		     	   or "Contact" in str(link.get("href")) \
                        and not "mailto" in str(link.get("href")) \
                            and not "privacy" in str(link.get("href")) \
                                and not "service" in str(link.get("href")) \
                                    and not "recruit" in str(link.get("href")) \
                                        and not "sdgs" in str(link.get("href")) \
		     	   or "INQ" in str(link.get("href")) \
                        and not "mailto" in str(link.get("href")) \
                            and not "privacy" in str(link.get("href")) \
                                and not "service" in str(link.get("href")) \
                                    and not "recruit" in str(link.get("href")) \
                                        and not "sdgs" in str(link.get("href")) \
		     	   or "Inq" in str(link.get("href")) \
                        and not "mailto" in str(link.get("href")) \
                            and not "privacy" in str(link.get("href")) \
                                and not "service" in str(link.get("href")) \
                                    and not "recruit" in str(link.get("href")) \
                                        and not "sdgs" in str(link.get("href")) \
		     	   or "inq" in str(link.get("href")) \
                        and not "mailto" in str(link.get("href")) \
                            and not "privacy" in str(link.get("href")) \
                                and not "service" in str(link.get("href")) \
                                    and not "recruit" in str(link.get("href")) \
                                        and not "sdgs" in str(link.get("href")) \
		     	   or r".info/" in str(link.get("href")) \
                        and not "privacy" in str(link.get("href")) \
                            and not "service" in str(link.get("href")) \
                                and not "recruit" in str(link.get("href")) \
                                    and not "sdgs" in str(link.get("href")) \
		     	   or r"/info" in str(link.get("href")) \
                        and not "privacy" in str(link.get("href")) \
                            and not "service" in str(link.get("href")) \
                                and not "recruit" in str(link.get("href")) \
                                    and not "sdgs" in str(link.get("href")) \
		     	   or "お問い合わせ" in str(link.get("href")) \
                        and not r"/よくある質問" in str(link.get("href")) \
		     	   or "お問合せ" in str(link.get("href")) \
                        and not r"/よくある質問" in str(link.get("href")) \
		     	   or "お問い合せ" in str(link.get("href")) \
                        and not r"/よくある質問" in str(link.get("href")) \
		     	   or "お問合わせ" in str(link.get("href")) \
                        and not r"/よくある質問" in str(link.get("href")) \
		     	   or "mail" in str(link.get("href")) \
                        and not "download" in str(link.get("href")) \
                            and not "mailto" in str(link.get("href")) \
                                and not "privacy" in str(link.get("href")) \
                                    and not "service" in str(link.get("href")) \
                                        and not "recruit" in str(link.get("href")) \
                                            and not "sdgs" in str(link.get("href")) \
                                                and not "magazine" in str(link.get("href")) \
		     	   or "mailto" in str(link.get("href")) \
                        and not "privacy" in str(link.get("href")) \
                            and not "service" in str(link.get("href")) \
                                and not "recruit" in str(link.get("href")) \
                                    and not "sdgs" in str(link.get("href")) \
		     	   or "page_id=233" in str(link.get("href")) \
		     	   or "page_id=39" in str(link.get("href")) \
		     	   or "page_id=93" in str(link.get("href")) \
		     	   or "page_id=15" in str(link.get("href")) \
		     	   or "page_id=3781" in str(link.get("href")) \
		     	   or r"form.run" in str(link.get("href")) \
		     	   or r"form.php" in str(link.get("href")) \
		     	   or r"/form$" in str(link.get("href")) \
		     	   or r"form.html" in str(link.get("href")) \
                   or "form" in str(link.get("href")) \
		     	   or r"%e3%81%8a%e5%95%8f%e3%81%84%e5%90%88%e3%82%8f%e3%81%9b" in str(link.get("href")) \
		     	   or r"ask.html" in str(link.get("href")) \
		     	   or r"/ask" in str(link.get("href")) \
		     	   or r"forms.gle" in str(link.get("href")) \
		     	   or "toiawase" in str(link.get("href")) \
		     	   or "faq" in str(link.get("href")) \
                        and not "mailto" in str(link.get("href")):
		        links_1.append(link.get("href"))   
#		        print(links_1)
		        print(len(links_1))

#「http」で始まる文字列のリスト
#		        if len([i for i in links_1 if r"^http" in i]) > 0:
		      links_2 = [i for i in links_1 \
                   if "http" in i and r".info/contact" in i \
                       or "http" in i and r"/faq" in i \
                           or "http" in i and not r"/info" in i \
                               or "http" in i and not "recruit" in i \
                                   or "http" in i and r"/ask" in i \
                                       or "http" in i and r"form2/B01" in i \
                                           or "http" in i and "contact" in i \
                                               or "http" in i and "mail" in i]
		      print(len(links_2))
#それ以外（"http"は含めない）
#		        elif len([j for j in links_1 if r"^http" in j]) == 0:
		      links_3 = [j for j in links_1 \
                   if r"/contact" in j and not "http" in j and not "mailto" in j \
                       or r"/CONTACT" in j and not "http" in j and not "mailto" in j \
                           or r"/Contact" in j and not "http" in j and not "mailto" in j \
                               or r"Contact/" in j and not "http" in j and not "mailto" in j \
                                   or r"mail/" in j and not "http" in j and not "mailto" in j \
                                       or r"#contact" in j and not "http" in j and not "mailto" in j \
                                           or r"#CONTACT" in j and not "http" in j and not "mailto" in j \
                                               or r"#Contact" in j and not "http" in j and not "mailto" in j \
                                                   or not "05contact" in j and not "http" in j and not "mailto" in j \
                                                       or r"CONTACT" in j and not "http" in j and not "mailto" in j \
                                                           or r"Contact" in j and not "http" in j and not "mailto" in j \
                                                               or r"/お問い合わせ" in j and not "http" in j and not "mailto" in j \
                                                                   or r"/お問合せ" in j and not "http" in j and not "mailto" in j \
                                                                       or r"/お問い合せ" in j and not "http" in j and not "mailto" in j \
                                                                           or r"/お問合わせ" in j and not "http" in j and not "mailto" in j \
                                                                               or r"page_id" in j and not "http" in j and not "mailto" in j \
                                                                                   or r"ask" in j and not "http" in j and not "mailto" in j \
                                                                                       or r".info/contact" in j and not "http" in j and not "mailto" in j \
                                                                                           or r"%e3%81%8a%e5%95%8f%e3%81%84%e5%90%88%e3%82%8f%e3%81%9b" in j and not "http" in j and not "mailto" in j \
                                                                                               or r"contact.html" in j and not "http" in j and not "mailto" in j \
                                                                                                   or r"/contact.html" in j and not "http" in j and not "mailto" in j \
                                                                                                       or r"_contact" in j and not "http" in j and not "mailto" in j \
                                                                                                           or r"contact.php" in j and not "http" in j and not "mailto" in j \
                                                                                                               or r"/mail" in j and not "http" in j and not "mailto" in j \
                                                                                                                   or r"forms.gle" in j and not "http" in j and not "mailto" in j \
                                                                                                                       or r"form.run" in j and not "http" in j and not "mailto" in j \
                                                                                                                           or r"section_contact" in j and not "http" in j and not "mailto" in j \
                                                                                                                               or r"form.php" in j and not "http" in j and not "mailto" in j \
                                                                                                                                   or r"/form$" in j and not "http" in j and not "mailto" in j \
                                                                                                                                       or "toiawase" in j and not "mailto" in j and not "http" in j \
                                                                                                                                           or "inq" in j and not "mailto" in j and not "http" in j \
                                                                                                                                               or "INQ" in j and not "mailto" in j and not "http" in j \
                                                                                                                                                   or "Inq" in j and not "mailto" in j and not "http" in j]
		      print(links_3)
		      print(len(links_3))
              
#メールアドレス（今は使用しない）
		      links_4 = [l for l in links_1 if "mailto" in l]
		      print(links_4)
		      print(len(links_4))

#リストlinks_4及びリストlinks_3が空でない、且つリストlinks_2が空である
		      if links_2 == [] \
		       and not links_3 == [] \
               and not links_4 == []:
		      		       if len(links_3) == 1:
		      		        ws3.update_cell(k, 6, ws3.cell(k, 5).value + links_3[0])
		      		        print(ws3.cell(k, 6).value)		      		      		      		      		      		         
		      		       elif 1 <= len(links_3) <= 5:
		      		        for j in range(1,len(links_3)):
		      		         time.sleep(3) 
		      		         ws3.update_cell(k, 6, ws3.cell(k, 5).value + links_3[j])
		      		         print(ws3.cell(k, 6).value)
		      		       elif len(links_3) > 5:
		      		        for j in range(1,len(links_3)):
		      		         time.sleep(3) 
		      		         ws3.update_cell(k, 6, ws3.cell(k, 5).value + links_3[j-1])
		      		         print(ws3.cell(k, 6).value)		      		         
#		      		         break

#リストlinks_4が空、リストlinks_3、且つリストlinks_2が空でない
		      elif not links_2 == [] \
		       and not links_3 == [] \
               and links_4 == []:
		       if len(links_2) == 1 and len(links_3) == 1:
		        ws3.update_cell(k, 6, links_2[0])
		        print(ws3.cell(k, 6).value)                         

		       elif len(links_2) > 1 and len(links_3) == 1:
		        for i in range(1,len(links_3)+1):    
		         time.sleep(1)
		         if r"//" in links_3[i-1]:
		          ws3.update_cell(k, 6, r"https:" + links_3[i-1])
		          print(ws3.cell(k, 6).value)
		         else:
		          ws3.update_cell(k, 6, ws3.cell(k, 5).value + links_3[i-1])
		          print(ws3.cell(k, 6).value)
		        
		       elif len(links_2) == 1 and len(links_3) > 1:
		        ws3.update_cell(k, 6, links_2[0])
		        print(ws3.cell(k, 6).value)
              
		       elif len(links_2) == 1 and len(links_3) > 1:
		        ws3.update_cell(k, 6, links_2[0])
		        print(ws3.cell(k, 6).value)

		       elif len(links_2) > 1 and len(links_3) > 1:
		        links_2 =[i for i in links_2 if "contact" in i \
		       		       and i is not None]
		        links_3 =[i for i in links_3 if "contact" in i \
		       		       and i is not None]
		        if len(links_2) > 0:
		         for i in range(1,len(links_2)):    
		          time.sleep(1)
		          ws3.update_cell(k, 6, links_2[i-1])
		          print(ws3.cell(k, 6).value)
		        elif len(links_3) > 0:
		         for j in range(1,len(links_3)):    
		          time.sleep(1)		        
		          ws3.update_cell(k, 6, ws3.cell(k, 5).value + links_3[j-1])
		          print(ws3.cell(k, 6).value)

#リストlinks_4が空、リストlinks_3が空、且つリストlinks_2が空でない		      		      		          
		      elif not links_2 == [] \
                  and links_3 == [] \
                      and links_4 == []:
		      		       if len(links_2) == 1:
		      		        ws3.update_cell(k, 6, links_2[0])
		      		        print(ws3.cell(k, 6).value)
#		      		        break
		      		       elif len(links_2) > 1:
		      		        links_2 = [i for i in links_2 if "contact" in i \
		      		      		      		         or "page_id=93" in i \
		      		      		      		      		        or "toiawase" in i]
		      		        for i in range(1,len(links_2)+1):
		      		         time.sleep(1)		      		        
		      		         ws3.update_cell(k, 6, links_2[i-1])		      		       
		      		         print(ws3.cell(k, 6).value)
#		      		         break
#リストlinks_4及びリストlinks_2が空、且つリストlinks_3が空でない		         
		      elif links_2 == [] \
                  and not links_3 == [] \
                      and links_4 == []:
		      		       if len(links_3) == 1:
		      		        ws3.update_cell(k, 6, ws3.cell(k, 5).value + links_3[0])
		      		        print(ws3.cell(k, 6).value)		      		      		      		      		      		         
		      		       elif 1 <= len(links_3) <= 5:
		      		        for j in range(1,len(links_3)):
		      		         time.sleep(3) 
		      		         ws3.update_cell(k, 6, ws3.cell(k, 5).value + links_3[j])
		      		         print(ws3.cell(k, 6).value)
		      		       elif len(links_3) > 5:
		      		        for j in range(1,len(links_3)):
		      		         time.sleep(3) 
		      		         ws3.update_cell(k, 6, ws3.cell(k, 5).value + links_3[j-1])
		      		         print(ws3.cell(k, 6).value)		      		         
#		      		         break
		          
#リストlink_4が空でない
		      elif links_2 == [] \
                  and links_3 == [] \
                      and not links_4 == []:
		      		        ws3.update_cell(k, 6, links_4[0])
		      		        print(ws3.cell(k, 6).value)
		      		        
#リストlink_2が空でない
		      elif not links_2 == [] \
                  and links_3 == [] \
                      and links_4 == []:
		      		        ws3.update_cell(k, 6, links_2[0])
		      		        print(ws3.cell(k, 6).value)		      		      		      		      		      		         
		      		        
#リストlink_3が空でない
		      elif links_2 == [] \
                  and not links_3 == [] \
                      and links_4 == []:
		      		        ws3.update_cell(k, 6, ws3.cell(k, 5).value + links_3[0])
		      		        print(ws3.cell(k, 6).value)		      		      		      		      		      		         

#リストlink_2及びリストlinks_3が空でない
		      elif not links_2 == [] \
                  and not links_3 == [] \
                      and links_4 == []:
		      		        ws3.update_cell(k, 6, links_2[0])
		      		        print(ws3.cell(k, 6).value)

#links_4、links_3、links_2の何れにおいても空である
		      elif links_2 == [] \
                  and links_3 == [] \
                      and links_4 == []:
		      		        ws3.update_cell(k, 6, "-")

		      else:
		         ws3.update_cell(k, 6, "-")
		     else:
		      ws3.update_cell(k, 6, "このサイトにアクセスできません")
		    else:
		      ws3.update_cell(k, 6, "-")
             
		    rate += 1/((row2+1)-row1)*100
            # 値の更新
		    dlg.Update(value=rate, newmsg="%d/100" % rate + "%")
           
		 dlg.Destroy()

#chromeドライバーの終了
		 driver.quit()

# calculate elapsed time
		 elapsed_time = int(time.time() - start)

# convert second to hour, minute and seconds
		 elapsed_hour = elapsed_time // 3600
		 elapsed_minute = (elapsed_time % 3600) // 60
		 elapsed_second = (elapsed_time % 3600 % 60)

# print as 00:00:00
		 print("所要時間：" + str(elapsed_hour).zfill(2) + "h" \
		       + str(elapsed_minute).zfill(2) + "m" + str(elapsed_second).zfill(2) + "s")

#MyDialogの各設定値をMyFrame5に受け渡し
		 adid = MyProject1MyFrame5(self)
		 adid.grid.ClearGrid()
		 dlg = wx.ProgressDialog(
            title="リスト取得中",
            message="0/100",
            maximum=100,
            style=wx.PD_AUTO_HIDE | wx.PD_ELAPSED_TIME | wx.PD_ESTIMATED_TIME | wx.PD_REMAINING_TIME )         
         
# ダイアログ表示
		 dlg.Show()
		 rate = 0

		 cell_list1 = ws3.range(1, 1, row2, 1)
		 cell_list2 = ws3.range(1, 2, row2, 2)
		 cell_list3 = ws3.range(1, 3, row2, 3)
		 cell_list4 = ws3.range(1, 4, row2, 4)
		 cell_list5 = ws3.range(1, 5, row2, 5)
		 cell_list6 = ws3.range(1, 6, row2, 6)
         
		 i = 0
		 for row in range(row2):           
		    adid.grid.SetCellValue(row, 0, cell_list1[i].value)
		    adid.grid.SetCellValue(row, 1, cell_list2[i].value)
		    adid.grid.SetCellValue(row, 2, cell_list3[i].value)
		    adid.grid.SetCellValue(row, 3, cell_list4[i].value)
		    adid.grid.SetCellValue(row, 4, cell_list5[i].value)
		    adid.grid.SetCellValue(row, 5, cell_list6[i].value)
#		    print(cell_list1[i].value)
#		    print(cell_list2[i].value)
#		    print(cell_list3[i].value)
#		    print(cell_list4[i].value)
#		    print(cell_list5[i].value)
#		    print(cell_list6[i].value)

		    i += 1
		    rate += 1/(row2+1)*100
            # 値の更新
		    dlg.Update(value=rate, newmsg="%d/100" % rate + "%")
           
		 dlg.Destroy()
		 adid.grid.AutoSize()
		 adid.Show()


	def inquiry_post( self, event ):
		adid = MyProject1MyDialog3(self)
		credentials = ServiceAccountCredentials.from_json_keyfile_name(adid.m_textCtrl11.GetValue(), scope)
		gc = gspread.authorize(credentials)                   
		row1 = self.row11.GetValue()
		row2 = self.row21.GetValue()

		if self.m_comboBox1.GetValue() == '選択して下さい':
		 self.m_comboBox1.SetBackgroundColour("#f56cbe")
		 wx.MessageBox(u'Please select the Worksheet title!!', u'Setting value error', wx.ICON_ERROR)
		elif row1 == 0 and row2 == 0:
		 self.row1.SetBackgroundColour('#f56cbe')
		 self.row2.SetBackgroundColour('#f56cbe')
		 self.m_comboBox1.SetBackgroundColour("#FFFFFF")
		 wx.MessageBox(u'Please set the range!!', u'Setting value error', wx.ICON_ERROR)
		elif row2 - row1 > 10000:
		 self.row1.SetBackgroundColour('#f56cbe')
		 self.row2.SetBackgroundColour('#f56cbe')
		 self.m_comboBox1.SetBackgroundColour("#FFFFFF")
		 wx.MessageBox(u'The value exceeds the configurable range!!', u'Setting value error', wx.ICON_ERROR)
		elif row2 - row1 < 0:
		 self.row1.SetBackgroundColour('#f56cbe')
		 self.row2.SetBackgroundColour('#f56cbe')
		 self.m_comboBox1.SetBackgroundColour("#FFFFFF")
		 wx.MessageBox(u'Illegal range!!', u'Setting value error', wx.ICON_ERROR)
		# Set cell values.
		else:
		 from selenium import webdriver
		 from selenium.webdriver.chrome.options import Options

#例外処理用のlibraryをimport
		 from selenium.common.exceptions import NoSuchElementException
		 from selenium.common.exceptions import WebDriverException
		 from selenium.common.exceptions import TimeoutException
		 from selenium.common.exceptions import ElementNotInteractableException

#Selectモジュールをインポート
		 #from selenium.webdriver.support.select import Select

#オプションの作成
		 option = Options()

#起動オプション
# ヘッドレスモードを有効にする（次の行をコメントアウトすると画面が表示される）。
		 option.add_argument('--headless')

#「unknown error: net::ERR_CONNECTION_CLOSED」の回避用
		 option.add_argument('--disable-dev-shm-usage')

# ChromeのWebDriverオブジェクトを作成する。
		 driver = webdriver.Chrome(adid.m_textCtrl111.GetValue(),options=option)
		 driver.set_page_load_timeout(60)
		 wb = gc.open_by_key(adid.m_comboBox6.GetValue())            
		 ws3 = wb.worksheet(self.m_comboBox11.GetValue())
		 self.row1.SetBackgroundColour('#FFFFFF')
		 self.row2.SetBackgroundColour('#FFFFFF')
		 self.m_comboBox1.SetBackgroundColour("#FFFFFF")
		 adid = MyProject1MyFrame5(self)
		 adid.grid.ClearGrid()
#		 self.m_gauge2.SetValue( 0 )
#		 self.m_gauge2.SetRange(row2-row1)
         
		 dlg = wx.ProgressDialog(
            title="自動投稿プログラム実行中",
            message="0/100",
            maximum=100,
            style=wx.PD_AUTO_HIDE | wx.PD_ELAPSED_TIME | wx.PD_ESTIMATED_TIME | wx.PD_REMAINING_TIME )         
         
# ダイアログ表示
		 dlg.Show()
		 rate = 0

#所要時間計測開始
		 start = time.time()

#お問い合わせフォームへの自動投稿本体プログラム
#ws1の行数を取得
		 lastrow = len(ws3.col_values(1))
		 for k in tqdm(range(row1, row2)):
    
#シートの初期化
 		  lastcol = len(list(ws3.row_values(k)))
 		  cell_list2 = ws3.range(k, 9, k, lastcol)
 		  print(cell_list2)
 		  for cell in cell_list2:
		    cell.value = ""
#             time.sleep(1)
 		  ws3.update_cells(cell_list2)

# try:
 		  if ws3.cell(k, 8).value == r"-" \
 		         or ws3.cell(k, 8).value == "" \
 		             or r"Time out!!" in ws3.cell(k, 8).value \
 		                 or r"unknown error!!" in ws3.cell(k, 8).value:
 		     ws3.update_cell(k, 9, "-")
 		  else:                
 		      driver.get(ws3.cell(k, 8).value)
 		      time.sleep(1)
 
 		      html = driver.page_source
 		      soup = BeautifulSoup(html, 'html.parser')

#フォーム送信ＮＧ
 		      if "営業のご連絡" in html \
 		        or "営業のお問い合わせ" in html \
 		            or "営業を目的" in html \
 		                or "営業目的" in html \
 		                    or "営業メール" in html \
 		                        or "弊社への営業" in html \
 		                            or "広告メール" in html \
 		                                or "フォームからの営業" in html \
 		                                    or "セールスのお問い合わせ" in html:
 		        ws3.update_cell(k, 9, "営業お断り！！")
 		      elif "recaptcha" in html:
 		        ws3.update_cell(k, 9, "reCAPTCHA")
     
 		      elif "このページはサービス" in html:
 		        ws3.update_cell(k, 9, "サービスに関する専用フォーム")

#自動送信対象     
 		      elif "確認" in str(soup.find_all("form")) \
 		        or "送信" in str(soup.find_all("form")) \
 		            or "お問い合わせ" in str(soup.find_all("form")) \
 		                or "メールアドレス" in str(soup.find_all("form")):
 		        ws3.update_cell(k, 9, "フォーム要素あり")

#labelタグのテキストを取得
 		        if "お問い合わせ" in str(soup.find_all("label")) \
 		                 or "メールアドレス" in str(soup.find_all("label")):
 		          element1 = soup.find_all("label")
 		          list_1 = []
 		          for list_ in element1:
 		            if "企業" in list_.getText() \
 		             or "社名" in list_.getText() \
 		             or "法人" in list_.getText() \
 		             or "ふりがな" in list_.getText() \
 		             or "フリガナ" in list_.getText() \
 		             or "カナ" in list_.getText() \
 		             or "担当者" in list_.getText() \
 		             or "役職" in list_.getText() \
 		             or "部署" in list_.getText() \
 		             or "郵便番号" in list_.getText() \
 		             or "都道府県" in list_.getText() \
 		             or "市区町村" in list_.getText() \
 		             or "番地" in list_.getText() \
 		             or "建物名" in list_.getText() \
 		             or "住所" in list_.getText() \
 		             or "所在地" in list_.getText() \
 		             or "お問い合わせ" in list_.getText() \
 		             or "お問合わせ" in list_.getText() \
 		             or "お問い合せ" in list_.getText() \
 		             or "お問合せ" in list_.getText() \
 		             or "名前" in list_.getText() \
 		             or "氏名" in list_.getText() \
 		             or "姓" in list_.getText() \
 		             or "名" in list_.getText() \
 		             or "電話" in list_.getText() \
 		             or "TEL" in list_.getText() \
 		             or "連絡先" in list_.getText() \
 		             or "メールアドレス" in list_.getText() \
 		             or "mail" in list_.getText() \
 		             or "URL" in list_.getText() \
 		             or "サイト" in list_.getText() \
 		             or "ホームページ" in list_.getText() \
 		             or "種別" in list_.getText() \
 		             or "業種" in list_.getText() \
 		             or "題名" in list_.getText() \
 		             or "本文" in list_.getText() \
 		             or "詳細" in list_.getText() \
 		             or "連絡方法" in list_.getText() \
 		             or "用件" in list_.getText() \
 		             or "件名" in list_.getText() \
 		             or "ご意見" in list_.getText() \
 		             or "返信方法" in list_.getText() \
 		             or "項目" in list_.getText():
 		             list_1.append(re.sub("[\n]", "", list_.getText(), 3))
 		          print(list_1)

#tdタグのテキストを取得
 		        if "お問い合わせ" in str(soup.find_all("td")) \
 		                 or "メールアドレス" in str(soup.find_all("td")):
 		          element1 = soup.find_all("td")
 		          list_1 = []
 		          for list_ in element1:
 		            if "企業" in list_.getText() \
 		             or "社名" in list_.getText() \
 		             or "法人" in list_.getText() \
 		             or "ふりがな" in list_.getText() \
 		             or "フリガナ" in list_.getText() \
 		             or "カナ" in list_.getText() \
 		             or "担当者" in list_.getText() \
 		             or "役職" in list_.getText() \
 		             or "部署" in list_.getText() \
 		             or "郵便番号" in list_.getText() \
 		             or "都道府県" in list_.getText() \
 		             or "市区町村" in list_.getText() \
 		             or "番地" in list_.getText() \
 		             or "建物名" in list_.getText() \
 		             or "住所" in list_.getText() \
 		             or "所在地" in list_.getText() \
 		             or "お問い合わせ" in list_.getText() \
 		             or "お問合わせ" in list_.getText() \
 		             or "お問い合せ" in list_.getText() \
 		             or "お問合せ" in list_.getText() \
 		             or "名前" in list_.getText() \
 		             or "氏名" in list_.getText() \
 		             or "姓" in list_.getText() \
 		             or "名" in list_.getText() \
 		             or "電話" in list_.getText() \
 		             or "TEL" in list_.getText() \
 		             or "連絡先" in list_.getText() \
 		             or "メールアドレス" in list_.getText() \
 		             or "mail" in list_.getText() \
 		             or "URL" in list_.getText() \
 		             or "サイト" in list_.getText() \
 		             or "ホームページ" in list_.getText() \
 		             or "種別" in list_.getText() \
 		             or "業種" in list_.getText() \
 		             or "題名" in list_.getText() \
 		             or "本文" in list_.getText() \
 		             or "詳細" in list_.getText() \
 		             or "連絡方法" in list_.getText() \
 		             or "用件" in list_.getText() \
 		             or "件名" in list_.getText() \
 		             or "ご意見" in list_.getText() \
 		             or "返信方法" in list_.getText() \
 		             or "項目" in list_.getText():
 		             list_1.append(re.sub("[\n]", "", list_.getText(), 3))
 		          print(list_1)

#dtタグのテキストを取得
 		        if "お問い合わせ" in str(soup.find_all("dt")) \
 		                 or "メールアドレス" in str(soup.find_all("dt")):
 		          element1 = soup.find_all("dt")
 		          list_1 = []
 		          for list_ in element1:
 		            if "企業" in list_.getText() \
 		             or "社名" in list_.getText() \
 		             or "法人" in list_.getText() \
 		             or "ふりがな" in list_.getText() \
 		             or "フリガナ" in list_.getText() \
 		             or "カナ" in list_.getText() \
 		             or "担当者" in list_.getText() \
 		             or "役職" in list_.getText() \
 		             or "部署" in list_.getText() \
 		             or "郵便番号" in list_.getText() \
 		             or "都道府県" in list_.getText() \
 		             or "市区町村" in list_.getText() \
 		             or "番地" in list_.getText() \
 		             or "建物名" in list_.getText() \
 		             or "住所" in list_.getText() \
 		             or "所在地" in list_.getText() \
 		             or "お問い合わせ" in list_.getText() \
 		             or "お問合わせ" in list_.getText() \
 		             or "お問い合せ" in list_.getText() \
 		             or "お問合せ" in list_.getText() \
 		             or "名前" in list_.getText() \
 		             or "氏名" in list_.getText() \
 		             or "姓" in list_.getText() \
 		             or "名" in list_.getText() \
 		             or "電話" in list_.getText() \
 		             or "TEL" in list_.getText() \
 		             or "連絡先" in list_.getText() \
 		             or "メールアドレス" in list_.getText() \
 		             or "mail" in list_.getText() \
 		             or "URL" in list_.getText() \
 		             or "サイト" in list_.getText() \
 		             or "ホームページ" in list_.getText() \
 		             or "種別" in list_.getText() \
 		             or "業種" in list_.getText() \
 		             or "題名" in list_.getText() \
 		             or "本文" in list_.getText() \
 		             or "詳細" in list_.getText() \
 		             or "連絡方法" in list_.getText() \
 		             or "用件" in list_.getText() \
 		             or "件名" in list_.getText() \
 		             or "ご意見" in list_.getText() \
 		             or "返信方法" in list_.getText() \
 		             or "項目" in list_.getText():
 		             list_1.append(re.sub("[\n]", "", list_.getText(), 3))
 		          print(list_1)

#pタグのテキストを取得
 		        if "お問い合わせ" in str(soup.find_all("p")) \
 		                 or "メールアドレス" in str(soup.find_all("p")):
 		          element1 = soup.find_all("p")
 		          list_1 = []
 		          for list_ in element1:
 		            if "企業" in list_.getText() \
 		             or "社名" in list_.getText() \
 		             or "法人" in list_.getText() \
 		             or "ふりがな" in list_.getText() \
 		             or "フリガナ" in list_.getText() \
 		             or "カナ" in list_.getText() \
 		             or "担当者" in list_.getText() \
 		             or "役職" in list_.getText() \
 		             or "部署" in list_.getText() \
 		             or "郵便番号" in list_.getText() \
 		             or "都道府県" in list_.getText() \
 		             or "市区町村" in list_.getText() \
 		             or "番地" in list_.getText() \
 		             or "建物名" in list_.getText() \
 		             or "住所" in list_.getText() \
 		             or "所在地" in list_.getText() \
 		             or "お問い合わせ" in list_.getText() \
 		             or "お問合わせ" in list_.getText() \
 		             or "お問い合せ" in list_.getText() \
 		             or "お問合せ" in list_.getText() \
 		             or "名前" in list_.getText() \
 		             or "氏名" in list_.getText() \
 		             or "姓" in list_.getText() \
 		             or "名" in list_.getText() \
 		             or "電話" in list_.getText() \
 		             or "TEL" in list_.getText() \
 		             or "連絡先" in list_.getText() \
 		             or "メールアドレス" in list_.getText() \
 		             or "mail" in list_.getText() \
 		             or "URL" in list_.getText() \
 		             or "サイト" in list_.getText() \
 		             or "ホームページ" in list_.getText() \
 		             or "種別" in list_.getText() \
 		             or "業種" in list_.getText() \
 		             or "題名" in list_.getText() \
 		             or "本文" in list_.getText() \
 		             or "詳細" in list_.getText() \
 		             or "連絡方法" in list_.getText() \
 		             or "用件" in list_.getText() \
 		             or "件名" in list_.getText() \
 		             or "ご意見" in list_.getText() \
 		             or "返信方法" in list_.getText() \
 		             or "項目" in list_.getText():
 		             list_1.append(re.sub("[\n]", "", list_.getText(), 3))
 		          print(list_1)

#thタグのテキストを取得
 		        if "お問い合わせ" in str(soup.find_all("th")) \
 		                 or "メールアドレス" in str(soup.find_all("th")):
 		          element1 = soup.find_all("th")
 		          list_1 = []
 		          for list_ in element1:
 		            if "企業" in list_.getText() \
 		             or "社名" in list_.getText() \
 		             or "法人" in list_.getText() \
 		             or "ふりがな" in list_.getText() \
 		             or "フリガナ" in list_.getText() \
 		             or "カナ" in list_.getText() \
 		             or "担当者" in list_.getText() \
 		             or "役職" in list_.getText() \
 		             or "部署" in list_.getText() \
 		             or "郵便番号" in list_.getText() \
 		             or "都道府県" in list_.getText() \
 		             or "市区町村" in list_.getText() \
 		             or "番地" in list_.getText() \
 		             or "建物名" in list_.getText() \
 		             or "住所" in list_.getText() \
 		             or "所在地" in list_.getText() \
 		             or "お問い合わせ" in list_.getText() \
 		             or "お問合わせ" in list_.getText() \
 		             or "お問い合せ" in list_.getText() \
 		             or "お問合せ" in list_.getText() \
 		             or "名前" in list_.getText() \
 		             or "氏名" in list_.getText() \
 		             or "姓" in list_.getText() \
 		             or "名" in list_.getText() \
 		             or "電話" in list_.getText() \
 		             or "TEL" in list_.getText() \
 		             or "連絡先" in list_.getText() \
 		             or "メールアドレス" in list_.getText() \
 		             or "mail" in list_.getText() \
 		             or "URL" in list_.getText() \
 		             or "サイト" in list_.getText() \
 		             or "ホームページ" in list_.getText() \
 		             or "種別" in list_.getText() \
 		             or "業種" in list_.getText() \
 		             or "題名" in list_.getText() \
 		             or "本文" in list_.getText() \
 		             or "詳細" in list_.getText() \
 		             or "連絡方法" in list_.getText() \
 		             or "用件" in list_.getText() \
 		             or "件名" in list_.getText() \
 		             or "ご意見" in list_.getText() \
 		             or "返信方法" in list_.getText() \
 		             or "項目" in list_.getText():
 		             list_1.append(re.sub("[\n]", "", list_.getText(), 3))
 		          print(list_1)

#指定のタグからテキストを取得しない場合
 		        else:
 		          element1 = soup.find_all("form")
 		          list_1 = []
 		          for list_ in element1:
 		            if "企業" in list_.getText() \
 		             or "社名" in list_.getText() \
 		             or "法人" in list_.getText() \
 		             or "ふりがな" in list_.getText() \
 		             or "フリガナ" in list_.getText() \
 		             or "カナ" in list_.getText() \
 		             or "担当者" in list_.getText() \
 		             or "役職" in list_.getText() \
 		             or "部署" in list_.getText() \
 		             or "郵便番号" in list_.getText() \
 		             or "都道府県" in list_.getText() \
 		             or "市区町村" in list_.getText() \
 		             or "番地" in list_.getText() \
 		             or "建物名" in list_.getText() \
 		             or "住所" in list_.getText() \
 		             or "所在地" in list_.getText() \
 		             or "お問い合わせ" in list_.getText() \
 		             or "お問合わせ" in list_.getText() \
 		             or "お問い合せ" in list_.getText() \
 		             or "お問合せ" in list_.getText() \
 		             or "名前" in list_.getText() \
 		             or "氏名" in list_.getText() \
 		             or "姓" in list_.getText() \
 		             or "名" in list_.getText() \
 		             or "電話" in list_.getText() \
 		             or "TEL" in list_.getText() \
 		             or "連絡先" in list_.getText() \
 		             or "メールアドレス" in list_.getText() \
 		             or "mail" in list_.getText() \
 		             or "URL" in list_.getText() \
 		             or "サイト" in list_.getText() \
 		             or "ホームページ" in list_.getText() \
 		             or "種別" in list_.getText() \
 		             or "業種" in list_.getText() \
 		             or "題名" in list_.getText() \
 		             or "本文" in list_.getText() \
 		             or "詳細" in list_.getText() \
 		             or "連絡方法" in list_.getText() \
 		             or "用件" in list_.getText() \
 		             or "件名" in list_.getText() \
 		             or "ご意見" in list_.getText() \
 		             or "返信方法" in list_.getText() \
 		             or "項目" in list_.getText():
 		             list_1.append(re.sub("[\n]", "", list_.getText(), 3))
 		          print(list_1)

 		        items_1 =[i.replace("必須", "") \
                     .replace("半角英数字", "") \
                         .replace("全角漢字", "") \
                             .replace("携帯電話可", "") \
                                 .replace("携帯可", "") \
                                     .replace("全角", "") \
                                         .replace(r"()","") \
                                             .replace(r"（）","") \
                                                 .replace(" ","") \
                                                     .replace(r"*","") \
                                                         .replace(r"※","") \
                                                             .split(r"・")[0] \
                                                                 for i in list_1]                  
#     print(items_1)

#inputタグの各要素を取得
 		        element2 = soup.find_all("input")
# 		         print(element2)
 		        list_2 = []
 		        list_2c = []
 		        list_2d = []
 		        list_2t = []
 		        list_2v = []

#inputタグの各要素を取得
 		        element3 = soup.find_all("button")
# 		         print(element2)
 		        list_3t = []

#各属性値
 		        for name in element2:
 		          list_2.append(name.get("name"))
# 		        print(list_2)
 		        print(len(list_2))
 		         		           
 		        for elem in element2:
# 		          items_1.append(name.get("placeholder"))
 		          list_2d.append(elem.get("id"))
# 		          print(items_2)


 		        for elem in element2:
# 		          items_1.append(name.get("placeholder"))
 		          list_2c.append(elem.get("class"))
# 		        print(list_2c)

 		        for elem in element2:
# 		          items_1.append(name.get("placeholder"))
 		          list_2t.append(elem.get("type"))
 		        print(list_2t)

 		        for elem in element3:
# 		          items_1.append(name.get("placeholder"))
 		          list_3t.append(elem.get("type"))
 		        print(list_3t)

 		        for elem in element2:
# 		          items_1.append(name.get("placeholder"))
 		          list_2v.append(elem.get("value"))
 		        print(list_2v)

#リストにNoneが含まれていると「TypeError: argument of type 'NoneType' is not iterable」
#が発生するので、リスト内包表記で処理

#name値
# 		        if not len(list_2) == 0:
 		        list_2 = [i for i in list_2 if i is not None]
 		        print(list_2)
 		          
#id値
# 		        if not len(list_2d) == 0:
 		        list_2d = [i for i in list_2d if i is not None]
# 		        print(list_2d)

#class値
# 		        if not len(list_2c) == 0:
 		        list_2c = [i for i in list_2c if i is not None]
 		        print(list_2c)

#value値
 		        list_2v = [i for i in list_2v if i is not None]
 		        print(list_2v)

#ラジオボタン
 		        element5 = soup.find_all("input",type="radio")
# 		        print(element5)
 		        element6 = soup.find_all("input",class_="questionTypeRadio")
# 		        print(element6)
 		        element7 = soup.find_all("input",attrs={"name":"questioner_type","type":"radio"})
# 		        print(element7)
 		         
 		        SELECT_list1 = []
 		        SELECT_list2 = []
 		        SELECT_list3 = []
 		        SELECT_list4 = []
 		        SELECT_list5 = []

 		        for elem in element5: 
 		           SELECT_list1.append(elem.get("value"))
 		           SELECT_list1 = [i for i in SELECT_list1 if i is not None]
 		        print(SELECT_list1)

 		        for elem in element5:
 		           SELECT_list2.append(elem.get("id"))
 		           SELECT_list2 = [i for i in SELECT_list2 if i is not None]
 		        print(SELECT_list2)

 		        for elem in element6: 
 		           SELECT_list3.append(elem.get("id"))
 		           SELECT_list3 = [i for i in SELECT_list3 if i is not None]
# 		           print(SELECT_list3)

 		        for elem in element7: 
 		           SELECT_list4.append(elem.get("id"))
 		           SELECT_list4 = [i for i in SELECT_list4 if i is not None]
 		        print(SELECT_list4)

 		        for elem in element5:
 		           SELECT_list5.append(elem.get("name"))
 		           SELECT_list5 = [i for i in SELECT_list5 if i is not None]
 		        print(SELECT_list5)

#value値のみ、id値なしの場合
 		        if len(SELECT_list1) > 0 \
                     and len(SELECT_list2) == 0 \
                         and len(SELECT_list3) == 0 \
                             and len(SELECT_list4) == 0 \
                                 and len(SELECT_list5) == 0:
 		          print(len(SELECT_list1))
 		          print(len(SELECT_list2))
 		          print(len(SELECT_list3))
 		          print(len(SELECT_list4))
 		          print(len(SELECT_list5))

#（区別）
 		          if len([i for i in SELECT_list1 if "法人" in i]) == 1:
 		            radiobutton = driver.find_element_by_css_selector("[value='法人']")
 		            driver.execute_script("arguments[0].click();", radiobutton)
 		            print(radiobutton.is_selected())
 		            if radiobutton.is_selected() is True:
 		         		         lastcol = len(list(ws3.row_values(k)))    
 		         		         time.sleep(1) 		         		           
 		         		         ws3.update_cell(k, lastcol+1, "法人")
 		         		         print(radiobutton.is_selected())

#（種別）
 		          if len([i for i in SELECT_list1 if "その他" == i]) == 1:
 		            radiobutton = driver.find_element_by_css_selector("[value='その他']")
 		            driver.execute_script("arguments[0].click();", radiobutton)
 		            print(radiobutton.is_selected())
 		            if radiobutton.is_selected() is True:
 		         		         lastcol = len(list(ws3.row_values(k)))    
 		         		         time.sleep(1) 		         		           
 		         		         ws3.update_cell(k, lastcol+1, "その他")
 		         		         print(radiobutton.is_selected())
 		         		         
#（アンケート:後で反映させる予定）
# 		          if "知りましたか" in str(soup.find_all("form")) \
# 		         		         and len([i for i in list_2 if "知りましたか" in i]) > 0:
# 		           radiobutton = driver.find_element_by_name(SELECT_list5[0])
# 		           print(SELECT_list5[0])
# 		           driver.execute_script("arguments[0].click();", radiobutton)
# 		           print(radiobutton.is_selected())
# 		           lastcol = len(list(ws3.row_values(k)))
# 		           time.sleep(1) 		         		           
# 		           ws3.update_cell(k, lastcol+1, SELECT_list5[0])
# 		           Cell_list9 = [i for i in list_2 if "知りましたか" in i]
# 		           print(Cell_list9)
# 		           driver.find_element_by_name(Cell_list9[0]).send_keys(ws2.cell(1, 3).value)
# 		           lastcol = len(list(ws3.row_values(k)))
# 		           time.sleep(1) 		         		           
# 		           ws3.update_cell(k, lastcol+1, ws2.cell(1, 3).value)
 		         		          
#（連絡方法）
 		          if len([i for i in SELECT_list1 if "メール" in i]) > 0:
 		            radiobutton = driver.find_element_by_css_selector("[value='メール']")
 		            driver.execute_script("arguments[0].click();", radiobutton)
 		            print(radiobutton.is_selected())
 		            if radiobutton.is_selected() is True:
 		         		         lastcol = len(list(ws3.row_values(k)))    
 		         		         time.sleep(1) 		         		           
 		         		         ws3.update_cell(k, lastcol+1, "メール")
 		         		         print(radiobutton.is_selected())


#value値及びid値有りの場合
 		        elif len(SELECT_list1) > 0 \
                     and len(SELECT_list2) > 0 \
                         and len(SELECT_list3) == 0 \
                             and len(SELECT_list4) == 0:
 		          print(len(SELECT_list1))
 		          print(len(SELECT_list2))
 		          print(len(SELECT_list3))
 		          print(len(SELECT_list4))

#（区別）
 		          if len([i for i in SELECT_list1 if "法人" in i]) == 1:
 		            radiobutton = driver.find_element_by_css_selector("[value='法人']")
 		            driver.execute_script("arguments[0].click();", radiobutton)
 		            print(radiobutton.is_selected())
 		            if radiobutton.is_selected() is True:
 		         		         lastcol = len(list(ws3.row_values(k)))    
 		         		         time.sleep(1) 		         		           
 		         		         ws3.update_cell(k, lastcol+1, "法人")
 		         		         print(radiobutton.is_selected())

#（種別）
 		          if "種別" in str(soup.find_all("form")) \
                       or "項目" in str(soup.find_all("form")) \
                           or "内容" in str(soup.find_all("form")):
 		           try:
 		            radiobutton = driver.find_elements_by_name(SELECT_list5[len(SELECT_list5)-1])[len(SELECT_list5)-1]
 		            driver.execute_script("arguments[0].click();", radiobutton)
 		            print(radiobutton.is_selected())
 		            lastcol = len(list(ws3.row_values(k))) 		         		         		         
 		            ws3.update_cell(k, lastcol+1, "その他")

#操作できない要素の回避
 		           except NoSuchElementException:
 		            try:   
 		         		        radiobutton = driver.find_element_by_css_selector("[value='その他']")
 		         		        driver.execute_script("arguments[0].click();", radiobutton)
 		         		        print(radiobutton.is_selected())
 		         		        lastcol = len(list(ws3.row_values(k))) 		         		         		         
 		         		        ws3.update_cell(k, lastcol+1, "その他")

#操作できない要素の回避
 		            except NoSuchElementException:
 		         		         pass

#value値及びname値有りの場合
 		        elif len(SELECT_list1) > 0 \
                     and len(SELECT_list2) == 0 \
                         and len(SELECT_list3) == 0 \
                             and len(SELECT_list4) == 0 \
                                 and len(SELECT_list5) > 0:
 		          print(len(SELECT_list1))
 		          print(len(SELECT_list2))
 		          print(len(SELECT_list3))
 		          print(len(SELECT_list4))
 		          print(len(SELECT_list5))

#（区別）
 		          if len([i for i in SELECT_list1 if "法人" in i]) == 1:
 		            radiobutton = driver.find_element_by_css_selector("[value='法人']")
 		            driver.execute_script("arguments[0].click();", radiobutton)
 		            print(radiobutton.is_selected())
 		            if radiobutton.is_selected() is True:
 		         		         lastcol = len(list(ws3.row_values(k)))    
 		         		         time.sleep(1) 		         		           
 		         		         ws3.update_cell(k, lastcol+1, "法人")
 		         		         print(radiobutton.is_selected())

#（種別）
 		          if "種別" in str(soup.find_all("form")) \
                       or "項目" in str(soup.find_all("form")) \
                           or "内容" in str(soup.find_all("form")) \
                               or "件名" in str(soup.find_all("form")):
# 		           radiobutton = driver.find_elements_by_name(SELECT_list5[len(SELECT_list5)-1])[len(SELECT_list5)-1]
 		           try:
 		         		        radiobutton = driver.find_element_by_css_selector("[value='other']")
 		         		        driver.execute_script("arguments[0].click();", radiobutton)
 		         		        print(radiobutton.is_selected())
 		         		        if radiobutton.is_selected() is True: 		           
 		         		          lastcol = len(list(ws3.row_values(k)))
 		         		          time.sleep(1)
 		         		          ws3.update_cell(k, lastcol+1, "その他")
 		           except NoSuchElementException:
 		         		        radiobutton = driver.find_element_by_css_selector("[value='その他のお問い合わせ']")
 		         		        driver.execute_script("arguments[0].click();", radiobutton)
 		         		        print(radiobutton.is_selected())
 		         		        if radiobutton.is_selected() is True: 		           
 		         		          lastcol = len(list(ws3.row_values(k)))
 		         		          time.sleep(1)
 		         		          ws3.update_cell(k, lastcol+1, "その他")


#id値有りの場合（パターン注意）
 		        elif len(SELECT_list3) > 0 \
                     and len(SELECT_list4) > 0:
 		          print(len(SELECT_list3))
 		          print(len(SELECT_list4))

#（種別）
 		          if len([i for i in items_1 if "種別" in i]) == 1:
 		            radiobutton = driver.find_element_by_id(SELECT_list3[len(SELECT_list3)-1])
 		            driver.execute_script("arguments[0].click();", radiobutton)
 		            print(radiobutton.is_selected())
 		            if radiobutton.is_selected() is True:
 		         		         lastcol = len(list(ws3.row_values(k)))    
 		         		         time.sleep(1) 		         		           
 		         		         ws3.update_cell(k, lastcol+1, SELECT_list3[len(SELECT_list3)-1])
 		         		         print(radiobutton.is_selected())

#（法人／個人）
 		        if len([i for i in items_1 if "法人" in i]) == 1 \
 		            and len(SELECT_list4) > 0:
 		            radiobutton = driver.find_element_by_id(SELECT_list4[0])
 		            driver.execute_script("arguments[0].click();", radiobutton)
 		            print(radiobutton.is_selected())
 		            if radiobutton.is_selected() is True:
 		         		         lastcol = len(list(ws3.row_values(k)))    
 		         		         time.sleep(1) 		         		           
 		         		         ws3.update_cell(k, lastcol+1, SELECT_list4[0])
 		         		         print(radiobutton.is_selected())


#会社名
 		        adid = MyProject1MyDialog4(self)
 		        if len([i for i in items_1 if "社名" in i \
 		         		         		        or "企業" in i \
 		         		         		            or "法人" in i]) == 0 \
 		            and len([i for i in list_2 if "社名" in i \
 		         		         		        or "企業" in i \
 		         		         		            or "法人" in i]) == 0:
 		           lastcol = len(list(ws3.row_values(k)))
 		           time.sleep(1) 
 		           ws3.update_cell(k, lastcol+1, "会社名入力欄なし")

#（Googleフォーム）
 		        elif not len([i for i in list_2c if "exportInput" in i]) == 0:
 		         driver.find_elements_by_css_selector(".quantumWizTextinputPaperinputInput.exportInput")[1].send_keys(adid.m_textCtrl11.GetValue())
 		         lastcol = len(list(ws3.row_values(k)))
 		         time.sleep(3)
 		         ws3.update_cell(k, lastcol+1, "会社名")

 		        elif not len([i for i in items_1 if "社名" in i \
 		         		         		        or "企業" in i \
 		         		         		            or "法人" in i]) == 0:
 		           Cell_list1 = [i for i in list_2 if "facility" in i \
                            or "organization" in i \
                                or "your-company" in i \
                                    or "company-name" in i \
                                        or "kaisha-name" in i \
                                            or "company" == i \
                                                or "contact_company" == i \
                                                    or "campany" in i \
                                                        or "your-corp" in i \
                                                            or "corporate" in i \
                                                                or "企業" in i \
                                                                    or "社名" in i \
                                                                        or "text-978" == i \
                                                                            or "Company" in i \
                                                                                or "company3" == i \
                                                                                    or "form_fields[company]" in i \
                                                                                        or "text-819" == i]
 		           driver.find_element_by_name(Cell_list1[0]).send_keys(adid.m_textCtrl11.GetValue() + "　")
 		           lastcol = len(list(ws3.row_values(k)))
 		           time.sleep(1)
 		           ws3.update_cell(k, lastcol+1, "会社名")
 		           print(Cell_list1)

 		        elif not len([i for i in list_2 if "facility" in i \
 		         		         		        or "organization" in i \
                                                       or "your-company" in i \
                                                           or "company-name" in i \
                                                               or "company" == i \
                                                                   or "contact_company" == i \
                                                                       or "campany" in i \
                                                                           or "your-corp" in i \
                                                                               or "corporate" in i \
                                                                                   or "name" in i \
                                                                                       or "企業" in i \
                                                                                           or "社名" in i \
                                                                                               or "text-978" == i \
                                                                                                   or "Company" in i \
                                                                                                       or "company3" == i \
                                                                                                           or "form_fields[company]" in i \
                                                                                                               or "text-819" == i]) == 0:
 		           Cell_list1 = [i for i in list_2 if "facility" in i \
                            or "organization" in i \
                                or "your-company" in i \
                                    or "company-name" in i \
                                        or "company" == i \
                                            or "contact_company" == i \
                                                or "campany" in i \
                                                    or "your-corp" in i \
                                                        or "corporate" in i \
                                                            or "name" in i \
                                                                or "企業" in i \
                                                                    or "社名" in i \
                                                                        or "text-978" == i \
                                                                            or "Company" in i \
                                                                                or "company3" == i \
                                                                                    or "form_fields[company]" in i \
                                                                                        or "text-819" == i]
 		           print(Cell_list1)
 		           driver.find_element_by_name(Cell_list1[0]).send_keys(adid.m_textCtrl11.GetValue() + "　")
 		           lastcol = len(list(ws3.row_values(k)))
 		           time.sleep(1) 
 		           ws3.update_cell(k, lastcol+1, "会社名")


 		        elif len([i for i in list_2 if "facility" in i \
                     or "organization" in i \
                         or "your-company" in i \
                             or "company-name" in i \
                                 or "company" == i \
                                     or "contact_company" == i \
                                         or "campany" in i \
                                             or "your-corp" in i \
                                                 or "corporate" in i \
                                                     or "name" in i \
                                                         or "企業" in i \
                                                             or "社名" in i \
                                                                 or "text-978" == i \
                                                                     or "Company" in i \
                                                                         or "company3" == i \
                                                                             or "form_fields[company]" in i \
                                                                                 or "text-819" == i]) == 0:
 		           Cell_list1 = [i for i in list_2c if "facility" in i \
                            or "organization" in i \
                                or "your-company" in i \
                                    or "company-name" in i \
                                        or "company" == i \
                                            or "contact_company" == i \
                                                or "campany" in i \
                                                    or "your-corp" in i \
                                                        or "corporate" in i \
                                                            or "name" in i \
                                                                or "企業" in i \
                                                                    or "社名" in i \
                                                                        or "text-978" == i \
                                                                            or "Company" in i \
                                                                                or "company3" == i \
                                                                                    or "form_fields[company]" in i \
                                                                                        or "text-819" == i]
 		           print(Cell_list1)
 		           driver.find_elements_by_class_name(Cell_list1[0])[1].send_keys(adid.m_textCtrl11.GetValue())
 		           lastcol = len(list(ws3.row_values(k)))
 		           time.sleep(1) 
 		           ws3.update_cell(k, lastcol+1, "会社名")


#会社名フリガナ
 		        if len([i for i in list_1 if "ふりがな（カナ）" in i]) == 0:
 		            pass
 		        elif len([i for i in list_1 if "ふりがな（カナ）" in i]) > 0:
 		          Cell_list2 = [i for i in list_2 if "企業名ふりがな（カナ）" in i]
 		          print(Cell_list2)
#テキスト入力
 		          driver.find_element_by_name(Cell_list2[0]).send_keys(adid.m_textCtrl13.GetValue())
 		          lastcol = len(list(ws3.row_values(k))) 		          
 		          time.sleep(1) 		         		           
 		          ws3.update_cell(k, lastcol+1, "会社名カナ")


#フルネーム（氏名）
 		           
#（Googleフォーム）
 		        if not len([i for i in list_2c if "exportInput" in i]) == 0:
 		         driver.find_elements_by_css_selector(".quantumWizTextinputPaperinputInput.exportInput")[0].send_keys(adid.m_textCtrl15.GetValue())
 		         lastcol = len(list(ws3.row_values(k)))
 		         time.sleep(3)
 		         ws3.update_cell(k, lastcol+1, "氏名")

 		        elif not len([i for i in items_1 if "担当者" in i \
                         or "名前" in i \
                             or "氏名" in i \
                                 or "姓" in i \
                                     or "名" in i]) == 0 \
                     or not len([i for i in list_2 if "担当者" in i \
                                 or "名前" in i \
                                     or "氏名" in i]) == 0:

#フルネーム（姓＋名）
 		         if len([i for i in list_2 if "姓" == i \
                    or "firstName" == i \
                        or "first_name" == i \
                            or "name1" == i \
                                or "FirstName" in i \
                                    or "firstname" in i \
                                        or "名" == i \
                                            or "lastName" == i \
                                                or "name2" == i \
                                                    or "LastName" in i \
                                                        or "name3" in i \
                                                            or "lastname" in i]) > 0:
 		            Cell_list3 = [i for i in list_2 if "姓" == i \
                             or "firstName" == i \
                                 or "first_name" == i \
                                     or "name1" == i \
                                         or "FirstName" in i \
                                             or "firstname" in i \
                                                 or "名" == i \
                                                     or "lastName" == i \
                                                         or "name2" == i \
                                                             or "LastName" in i \
                                                                 or "name3" in i \
                                                                     or "lastname" in i]
 		            print(Cell_list3)
 		            for j in range(1,len(Cell_list3)+1):
 		         		        elemName0 = driver.find_element_by_name(Cell_list3[0])
 		         		        elemName1 = driver.find_element_by_name(Cell_list3[1])
 		         		        
 		         		        if len(Cell_list3) > 2:
 		         		         elemName2 = driver.find_element_by_name(Cell_list3[2])
 		         		         try:
 		         		          if elemName0.is_displayed() is False \
 		         		         		        or elemName1.is_displayed() is False \
 		         		         		            or elemName2.is_displayed() is False:
 		         		         		        print(Cell_list3[j-1])
 		         		         		        if "1" in Cell_list3[j-1]:
 		         		         		         driver.find_element_by_name(Cell_list3[j-1]).send_keys(adid.m_textCtrl16.GetValue()
                                                                                         + adid.m_textCtrl17.GetValue())
 		         		         		         lastcol = len(list(ws3.row_values(k)))
 		         		         		         time.sleep(1) 		         		           
 		         		         		         ws3.update_cell(k, lastcol+1, "氏名")

 		         		         		        elif "2" in Cell_list3[j-1]:
 		         		         		         driver.find_element_by_name(Cell_list3[j-1]).send_keys(adid.m_textCtrl16.GetValue()
                                                                                         + adid.m_textCtrl17.GetValue())
 		         		         		         lastcol = len(list(ws3.row_values(k)))
 		         		         		         time.sleep(1) 		         		           
 		         		         		         ws3.update_cell(k, lastcol+1, "氏名")

 		         		         		        elif "3" in Cell_list3[j-1]:
 		         		         		         driver.find_element_by_name(Cell_list3[j-1]).send_keys(adid.m_textCtrl16.GetValue()
                                                                                         + adid.m_textCtrl17.GetValue())
 		         		         		         lastcol = len(list(ws3.row_values(k)))
 		         		         		         time.sleep(1) 		         		           
 		         		         		         ws3.update_cell(k, lastcol+1, "氏名")

#操作できない要素の回避
 		         		         except ElementNotInteractableException:
 		         		           pass

# 		         		        else:
# 		         		         		        driver.find_element_by_name(Cell_list3[j-1]).send_keys(ws2.cell(6, 2+j).value)
# 		         		         		        lastcol = len(list(ws3.row_values(k)))
# 		         		         		        time.sleep(1) 
# 		         		         		        ws3.update_cell(k, lastcol+1, ws2.cell(6, 2+j).value)
 		           
#フルネーム（通常パターン）
 		         elif not len([i for i in list_2 if r"user_name" in i \
                          or r"your-name" in i \
                              or "contact_name" in i \
                                  or "名前" in i \
                                      or "f4a6f2b" in i \
                                          or "担当者" in i \
                                              or "氏名" in i \
                                                  or "name" == i \
                                                      or "name1" == i \
                                                          or "text-978" == i \
                                                              or "firstname" == i \
                                                                  or "full_name" == i \
                                                                      or "customer_name" == i \
                                                                          or "namae" in i \
                                                                              or "form_fields[name]" in i \
                                                                                  or "NAME" == i]) == 0:
 		           Cell_list3 = [i for i in list_2 if r"user_name" in i \
                            or r"your-name" in i \
                                or "contact_name" in i \
                                    or "名前" in i \
                                        or "f4a6f2b" in i \
                                            or "担当者" in i \
                                                or "氏名" in i \
                                                    or "name" == i \
                                                        or "name1" == i \
                                                            or "text-978" == i \
                                                                or "firstname" == i \
                                                                    or "full_name" == i \
                                                                        or "customer_name" == i \
                                                                            or "namae" in i \
                                                                                or "form_fields[name]" in i \
                                                                                    or "NAME" == i]
 		           print(Cell_list3)
 		           driver.find_element_by_name(Cell_list3[0]).send_keys(adid.m_textCtrl15.GetValue())
 		           lastcol = len(list(ws3.row_values(k)))
 		           time.sleep(1) 
 		           ws3.update_cell(k, lastcol+1, "氏名")

 		         elif len([i for i in list_2 if r"user_name" in i \
                      or r"your-name" in i \
                          or "contact_name" in i \
                              or "名前" in i \
                                  or "f4a6f2b" in i \
                                      or "担当者" in i \
                                          or "氏名" in i \
                                              or "name" == i \
                                                  or "name1" == i \
                                                      or "text-978" == i \
                                                          or "firstname" == i \
                                                              or "full_name" == i \
                                                                  or "customer_name" == i \
                                                                      or "namae" in i \
                                                                          or "form_fields[name]" in i \
                                                                              or "NAME" == i]) == 0:
 		           Cell_list3 = [i for i in list_2d if r"user_name" in i \
                            or r"your-name" in i \
                                or "contact_name" in i \
                                    or "名前" in i \
                                        or "f4a6f2b" in i \
                                            or "担当者" in i \
                                                or "氏名" in i \
                                                    or "name" == i \
                                                        or "name1" == i \
                                                            or "text-978" == i \
                                                                or "firstname" == i \
                                                                    or "full_name" == i \
                                                                        or "customer_name" == i \
                                                                            or "namae" in i \
                                                                                or "form_fields[name]" in i \
                                                                                    or "NAME" == i]
 		           print(Cell_list3)
 		           driver.find_element_by_id(Cell_list3[0]).send_keys(adid.m_textCtrl15.GetValue())
 		           lastcol = len(list(ws3.row_values(k)))
 		           time.sleep(1) 
 		           ws3.update_cell(k, lastcol+1, "氏名")

 		         elif len([i for i in list_2d if r"user_name" in i \
                      or r"your-name" in i \
                          or "名前" in i \
                              or "contact_name" in i \
                                  or "f4a6f2b" in i \
                                      or "担当者" in i \
                                          or "氏名" in i \
                                              or "name" == i \
                                                  or "name1" == i \
                                                      or "text-978" == i \
                                                          or "firstname" == i \
                                                              or "full_name" == i \
                                                                  or "customer_name" == i \
                                                                      or "namae" in i \
                                                                          or "form_fields[name]" in i \
                                                                              or "NAME" == i]) == 0:
 		           Cell_list3 = [i for i in list_2c if r"user_name" in i \
                            or r"your-name" in i \
                                or "contact_name" in i \
                                    or "名前" in i \
                                        or "f4a6f2b" in i \
                                            or "担当者" in i \
                                                or "氏名" in i \
                                                    or "name" == i \
                                                        or "name1" == i \
                                                            or "text-978" == i \
                                                                or "firstname" == i \
                                                                    or "full_name" == i \
                                                                        or "customer_name" == i \
                                                                            or "namae" in i \
                                                                                or "form_fields[name]" in i \
                                                                                    or "NAME" == i]
 		           print(Cell_list3)
 		           driver.find_elements_by_class_name(list_2c[0])[0].send_keys(adid.m_textCtrl15.GetValue())
 		           lastcol = len(list(ws3.row_values(k)))
 		           time.sleep(1)
 		           ws3.update_cell(k, lastcol+1, "氏名")

#フルネームふりがな
 		        if len([i for i in list_1 if "ふりがな" in i]) == 0:
 		         pass
 		        elif not len([i for i in list_1 if "ふりがな" in i]) == 0:
 		          if len([i for i in list_2 if "せい" == i \
                     or "めい" == i]) > 0:
 		           Cell_list5 = [i for i in list_2 if "せい" == i \
                            or "めい" == i]
 		           print(Cell_list5)
# 		           for j in range(1,len(Cell_list5)+1):
# 		            print(Cell_list5[j-1])
 		           driver.find_element_by_name(Cell_list5[0]).send_keys(adid.m_textCtrl19.GetValue())
 		           lastcol = len(list(ws3.row_values(k)))
 		           time.sleep(1) 		         		           
 		           ws3.update_cell(k, lastcol+1, adid.m_textCtrl19.GetValue())
 		           driver.find_element_by_name(Cell_list5[1]).send_keys(adid.m_textCtrl20.GetValue())
 		           lastcol = len(list(ws3.row_values(k)))
 		           time.sleep(1) 		         		           
 		           ws3.update_cell(k, lastcol+1, adid.m_textCtrl20.GetValue())         
 		          elif len([i for i in list_2 if "your-kana" in i \
                       or "userKana" in i \
                           or "personal_kana_name" in i \
                               or "name_ruby" in i \
                                   or "ふりがな" in i]) > 0:
 		           Cell_list5 = [i for i in list_2 if "your-kana" in i \
                            or "userKana" in i \
                                or "personal_kana_name" in i \
                                    or "name_ruby" in i \
                                        or "ふりがな" in i]
 		           print(Cell_list5)
 		           driver.find_element_by_name(Cell_list5[0]).send_keys(adid.m_textCtrl18.GetValue())
 		           lastcol = len(list(ws3.row_values(k)))
 		           time.sleep(1) 		         		           
 		           ws3.update_cell(k, lastcol+1, "氏名ふりがな")


#フルネームカタカナ
 		        if len([i for i in list_1 if "フリガナ" in i \
                   or "名前（カナ）" in i]) == 0:
 		            pass
 		        elif not len([i for i in list_1 if "フリガナ" in i \
                         or "名前（カナ）" in i]) == 0:
 		            
#（セイ＋メイ）
 		          if len([i for i in list_2 if "セイ" == i \
                     or "メイ" == i \
                         or "firstKanaName" == i \
                             or "lastKanaName" == i \
                                 or "kana_first_name" in i \
                                     or "kana_last_name" in i]) > 0:
 		           Cell_list5 = [i for i in list_2 if "セイ" == i \
                            or "メイ" == i \
                                or "firstKanaName" == i \
                                    or "lastKanaName" == i \
                                        or "kana_first_name" in i \
                                            or "kana_last_name" in i]
 		           print(Cell_list5)
# 		           for j in range(1,len(Cell_list5)+1):
# 		            print(Cell_list5[j-1])
 		           driver.find_element_by_name(Cell_list5[0]).send_keys(adid.m_textCtrl22.GetValue())
 		           lastcol = len(list(ws3.row_values(k)))
 		           time.sleep(1) 		         		           
 		           ws3.update_cell(k, lastcol+1, adid.m_textCtrl22.GetValue())
 		           driver.find_element_by_name(Cell_list5[1]).send_keys(adid.m_textCtrl23.GetValue())
 		           lastcol = len(list(ws3.row_values(k)))
 		           time.sleep(1) 		         		           
 		           ws3.update_cell(k, lastcol+1, adid.m_textCtrl23.GetValue())         

#（セイメイ）
 		          elif len([i for i in list_2 if "your-kana" in i \
                       or "name_furi" in i \
                           or "フリガナ" in i \
                               or "name1-kana" == i \
                                   or "furigana" == i \
                                       or "kana" == i \
                                           or "NAME_KANA" == i]) > 0:
 		           Cell_list5 = [i for i in list_2 if "your-kana" in i \
                            or "name_furi" in i \
                                or "フリガナ" in i \
                                    or "name1-kana" == i \
                                        or "furigana" == i \
                                            or "kana" == i \
                                                or "NAME_KANA" == i]
 		           print(Cell_list5)
 		           driver.find_element_by_name(Cell_list5[0]).send_keys(adid.m_textCtrl21.GetValue())
 		           lastcol = len(list(ws3.row_values(k)))
 		           time.sleep(1) 		         		           
 		           ws3.update_cell(k, lastcol+1, "氏名フリガナ")



class MyProject1MyDialog( app.MyDialog ):
    def __init__(self, parent):
        app.MyDialog.__init__(self, parent)
        self.parent = parent

#        mainBox.Add( hbox1, 1, wx.EXPAND, 5 )
#        self.m_panel6 = wx.Panel( self.main_panel, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        
        self.m_panel6.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        sbSizer5 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel6, wx.ID_ANY, u"Please set the value." ), wx.VERTICAL )

        self.m_panel5 = wx.Panel( sbSizer5.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        bSizer16 = wx.BoxSizer( wx.VERTICAL )

        gSizer5 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel17 = wx.Panel( self.m_panel5, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_panel17.SetFont( wx.Font( 10, wx.FONTFAMILY_MODERN, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        sbSizer15 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel17, wx.ID_ANY, u"Check the page list." ), wx.VERTICAL )

#        m_comboBox1Choices = []
#        self.m_comboBox1 = wx.ComboBox( sbSizer15.GetStaticBox(), wx.ID_ANY, u"Combo!", wx.DefaultPosition, wx.DefaultSize, m_comboBox1Choices, wx.CB_DROPDOWN )

        adid = MyProject1MyDialog3(self)
                
#秘密鍵（JSONファイル）のファイル名を入力
        credentials = ServiceAccountCredentials.from_json_keyfile_name(adid.m_textCtrl11.GetValue(), scope)

#OAuth2の資格情報を使用してGoogle APIにログインします。
        gc = gspread.authorize(credentials)

#存在するワークシートの情報を全て取得
        wb = gc.open_by_key(adid.m_comboBox6.GetValue())
        worksheets = wb.worksheets()
        
#現在のワークシートのタイトルをリストへ格納
        m_comboBox1Choices = [worksheet.title for worksheet in worksheets]
#        print(m_comboBox1Choices)
        self.m_comboBox1 = wx.ComboBox( sbSizer15.GetStaticBox(), wx.ID_ANY, u"選択して下さい", wx.DefaultPosition, wx.Size( 100,-1 ), m_comboBox1Choices, wx.CB_DROPDOWN )
        
        sbSizer15.Add( self.m_comboBox1, 0, wx.ALL, 5 )
        
#（ページ一覧：スプレッドシート参照不要によりドロップボックスを無効）        
        self.m_comboBox1.Enable(False)

        self.dbtn2 = wx.Button( sbSizer15.GetStaticBox(), wx.ID_ANY, u"View index", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.dbtn2.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        sbSizer15.Add( self.dbtn2, 0, wx.ALL, 5 )


        self.m_panel17.SetSizer( sbSizer15 )
        self.m_panel17.Layout()
        sbSizer15.Fit( self.m_panel17 )
        gSizer5.Add( self.m_panel17, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel23 = wx.Panel( self.m_panel5, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )

        sbSizer18 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel23, wx.ID_ANY, u"Header list" ), wx.VERTICAL )

        sbSizer18.SetMinSize( wx.Size( 20,-1 ) )
        gSizer6 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_staticText5 = wx.StaticText( sbSizer18.GetStaticBox(), wx.ID_ANY, u"start", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_staticText5.Wrap( -1 )

        self.m_staticText5.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        gSizer6.Add( self.m_staticText5, 0, wx.ALL|wx.ALIGN_RIGHT, 5 )

        self.row1 = wx.SpinCtrl( sbSizer18.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 50,-1 ), wx.SP_ARROW_KEYS, 0, 10000, 0 )
        gSizer6.Add( self.row1, 0, wx.ALL, 5 )

        self.m_staticText6 = wx.StaticText( sbSizer18.GetStaticBox(), wx.ID_ANY, u"last", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_staticText6.Wrap( -1 )

        gSizer6.Add( self.m_staticText6, 0, wx.ALL|wx.ALIGN_RIGHT, 5 )

        self.row2 = wx.SpinCtrl( sbSizer18.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 50,-1 ), wx.SP_ARROW_KEYS, 0, 10000, 0 )
        gSizer6.Add( self.row2, 0, wx.ALL, 5 )

        m_comboBox3Choices = [worksheet.title for worksheet in worksheets]
        self.m_comboBox3 = wx.ComboBox( sbSizer18.GetStaticBox(), wx.ID_ANY, u"選択して下さい", wx.DefaultPosition, wx.Size( 100,-1 ), m_comboBox3Choices, 0 )
        gSizer6.Add( self.m_comboBox3, 0, wx.ALL, 5 )

        self.btn3 = wx.Button( sbSizer18.GetStaticBox(), wx.ID_ANY, u"Get", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.btn3.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        gSizer6.Add( self.btn3, 0, wx.ALL|wx.ALIGN_RIGHT, 5 )


        sbSizer18.Add( gSizer6, 1, wx.EXPAND, 5 )


        self.m_panel23.SetSizer( sbSizer18 )
        self.m_panel23.Layout()
        sbSizer18.Fit( self.m_panel23 )
        gSizer5.Add( self.m_panel23, 1, wx.EXPAND |wx.ALL, 5 )


        bSizer16.Add( gSizer5, 1, wx.EXPAND, 5 )


        self.m_panel5.SetSizer( bSizer16 )
        self.m_panel5.Layout()
        bSizer16.Fit( self.m_panel5 )
        sbSizer5.Add( self.m_panel5, 1, wx.EXPAND |wx.ALL, 5 )


        self.m_panel6.SetSizer( sbSizer5 )
        self.m_panel6.Layout()
        sbSizer5.Fit( self.m_panel6 )
#        hbox1.Add( self.m_panel6, 1, wx.EXPAND |wx.ALL, 5 )


#        mainBox.Add( hbox1, 1, wx.EXPAND, 5 )

#        hbox4 = wx.BoxSizer( wx.VERTICAL )

#        self.m_panel15 = wx.Panel( self.main_panel, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_panel15.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        sbSizer12 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel15, wx.ID_ANY, u"Please set the value." ), wx.VERTICAL )

        self.m_panel14 = wx.Panel( sbSizer12.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        bSizer161 = wx.BoxSizer( wx.VERTICAL )

        gSizer51 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel151 = wx.Panel( self.m_panel14, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer151 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel151, wx.ID_ANY, u"Confirmation of result." ), wx.VERTICAL )

#現在のワークシートのタイトルをリストへ格納
        m_comboBox11Choices = [worksheet.title for worksheet in worksheets]
#        print(m_comboBox11Choices)
        self.m_comboBox11 = wx.ComboBox( sbSizer151.GetStaticBox(), wx.ID_ANY, u"選択して下さい", wx.DefaultPosition, wx.Size( 100,-1 ), m_comboBox11Choices, wx.CB_DROPDOWN )
        sbSizer151.Add( self.m_comboBox11, 0, wx.ALL, 5 )

        self.dbtn21 = wx.Button( sbSizer151.GetStaticBox(), wx.ID_ANY, u"Confirm", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.dbtn21.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        sbSizer151.Add( self.dbtn21, 0, wx.ALL, 5 )


        self.m_panel151.SetSizer( sbSizer151 )
        self.m_panel151.Layout()
        sbSizer151.Fit( self.m_panel151 )
        gSizer51.Add( self.m_panel151, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel16 = wx.Panel( self.m_panel14, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer16 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel16, wx.ID_ANY, u"Get detailed information." ), wx.VERTICAL )

        gSizer61 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_staticText51 = wx.StaticText( sbSizer16.GetStaticBox(), wx.ID_ANY, u"start", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_staticText51.Wrap( -1 )

        self.m_staticText51.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        gSizer61.Add( self.m_staticText51, 0, wx.ALL|wx.ALIGN_RIGHT, 5 )

        self.row3 = wx.SpinCtrl( sbSizer16.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 50,-1 ), wx.SP_ARROW_KEYS, 0, 10000, 0 )
        gSizer61.Add( self.row3, 0, wx.ALL, 5 )

        self.m_staticText61 = wx.StaticText( sbSizer16.GetStaticBox(), wx.ID_ANY, u"last", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_staticText61.Wrap( -1 )

        gSizer61.Add( self.m_staticText61, 0, wx.ALL|wx.ALIGN_RIGHT, 5 )

        self.row4 = wx.SpinCtrl( sbSizer16.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 50,-1 ), wx.SP_ARROW_KEYS, 0, 10000, 0 )
        gSizer61.Add( self.row4, 0, wx.ALL, 5 )

#現在のワークシートのタイトルをリストへ格納
        m_comboBox31Choices = [worksheet.title for worksheet in worksheets]
#        print(m_comboBox31Choices)
        self.m_comboBox31 = wx.ComboBox( sbSizer16.GetStaticBox(), wx.ID_ANY, u"選択して下さい", wx.DefaultPosition, wx.Size( 100,-1 ), m_comboBox31Choices, 0 )
        gSizer61.Add( self.m_comboBox31, 0, wx.ALL, 5 )

        self.btn4 = wx.Button( sbSizer16.GetStaticBox(), wx.ID_ANY, u"Get", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.btn4.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        gSizer61.Add( self.btn4, 0, wx.ALL|wx.ALIGN_RIGHT, 5 )


        sbSizer16.Add( gSizer61, 1, wx.EXPAND, 5 )


        self.m_panel16.SetSizer( sbSizer16 )
        self.m_panel16.Layout()
        sbSizer16.Fit( self.m_panel16 )
        gSizer51.Add( self.m_panel16, 1, wx.EXPAND |wx.ALL, 5 )


        bSizer161.Add( gSizer51, 1, wx.EXPAND, 5 )


        self.m_panel14.SetSizer( bSizer161 )
        self.m_panel14.Layout()
        bSizer161.Fit( self.m_panel14 )
        sbSizer12.Add( self.m_panel14, 1, wx.EXPAND |wx.ALL, 5 )


        self.m_panel15.SetSizer( sbSizer12 )
        self.m_panel15.Layout()
        sbSizer12.Fit( self.m_panel15 )


#存在するワークシートの情報を全て取得
#        wb = gc.open_by_key(key)
#        worksheets = wb.worksheets()
        
#現在のワークシートのタイトルをリストへ格納
#        m_comboBox1Choices = [worksheet.title for worksheet in worksheets]
#        print(m_comboBox1Choices)
#        self.m_comboBox1 = wx.ComboBox( sbSizer15.GetStaticBox(), wx.ID_ANY, u"選択して下さい", wx.DefaultPosition, wx.DefaultSize, m_comboBox1Choices, wx.CB_DROPDOWN )

#Connect Events
        self.Bind( wx.EVT_CLOSE, self.quit_button )
        self.btn3.Bind( wx.EVT_BUTTON, self.header )
        self.btn4.Bind( wx.EVT_BUTTON, self.Get_details )
        self.dbtn2.Bind( wx.EVT_BUTTON, self.page_list )
        self.dbtn21.Bind( wx.EVT_BUTTON, self.list_view )


    def header( self, event ):
        adid = MyProject1MyDialog3(self)
        credentials = ServiceAccountCredentials.from_json_keyfile_name(adid.m_textCtrl11.GetValue(), scope)
        gc = gspread.authorize(credentials)                   
        row1 = self.row1.GetValue()
        row2 = self.row2.GetValue()
#        print(row1)
#        print(row2)        

#        if self.m_comboBox1.GetValue() == '選択して下さい' \
#            or self.m_comboBox3.GetValue() == '選択して下さい':
#         self.m_comboBox1.SetBackgroundColour("#ff0000")
#         self.m_comboBox3.SetBackgroundColour("#ff0000")         
#         wx.MessageBox(u'Please select the Worksheet title!!', u'Setting value error', wx.ICON_ERROR)
#        elif not 'page' in self.m_comboBox1.GetValue() \
#            or not 'リスト' in self.m_comboBox3.GetValue():
#         self.m_comboBox1.SetBackgroundColour("#ff0000")
#         self.m_comboBox3.SetBackgroundColour("#ff0000")         
#         wx.MessageBox(u'Not a valid sheet name.!!', u'Setting value error', wx.ICON_ERROR)            
        if row1 == 0 or row2 == 0:
         self.row1.SetBackgroundColour('#ff0000')
         self.row2.SetBackgroundColour('#ff0000')
#         self.m_comboBox1.SetBackgroundColour("#FFFFFF")
         self.m_comboBox3.SetBackgroundColour("#FFFFFF")         
         wx.MessageBox(u'Please set the range!!', u'Setting value error', wx.ICON_ERROR)
        elif row2 - row1 > 391:
         self.row1.SetBackgroundColour('#ff0000')
         self.row2.SetBackgroundColour('#ff0000')
#         self.m_comboBox1.SetBackgroundColour("#FFFFFF")
         self.m_comboBox3.SetBackgroundColour("#FFFFFF")         
         wx.MessageBox(u'The value exceeds the configurable range!!', u'Setting value error', wx.ICON_ERROR)
        elif row2 - row1 < 0:
         self.row1.SetBackgroundColour('#ff0000')
         self.row2.SetBackgroundColour('#ff0000')
#         self.m_comboBox1.SetBackgroundColour("#FFFFFF")
         self.m_comboBox3.SetBackgroundColour("#FFFFFF")         
         wx.MessageBox(u'Illegal range!!', u'Setting value error', wx.ICON_ERROR)
        elif self.m_comboBox3.GetValue() == '選択して下さい':
         self.m_comboBox3.SetBackgroundColour("#ff0000")      
         wx.MessageBox(u'Please select the Worksheet title!!', u'Setting value error', wx.ICON_ERROR)
        elif not 'リスト' in self.m_comboBox3.GetValue():
         self.m_comboBox3.SetBackgroundColour("#ff0000")         
         wx.MessageBox(u'Not a valid sheet name.!!', u'Setting value error', wx.ICON_ERROR)            
         
		# Set cell values.
        else:
         from selenium import webdriver
         from selenium.webdriver.chrome.options import Options

#例外処理用のlibraryをimport
         from selenium.common.exceptions import NoSuchElementException
         from selenium.common.exceptions import WebDriverException
         from selenium.common.exceptions import TimeoutException

#Selectモジュールをインポート
		 #from selenium.webdriver.support.select import Select

#オプションの作成
         option = Options()

#起動オプション
# ヘッドレスモードを有効にする（次の行をコメントアウトすると画面が表示される）。
         option.add_argument('--headless')

#「unknown error: net::ERR_CONNECTION_CLOSED」の回避用
         option.add_argument('--disable-dev-shm-usage')

# ChromeのWebDriverオブジェクトを作成する。

#「パスが通っていません」というエラーが出るためコメントアウトする
         driver = webdriver.Chrome(adid.m_textCtrl111.GetValue(),options=option)
         driver.set_page_load_timeout(60)
            
         wb = gc.open_by_key(adid.m_comboBox6.GetValue())
#         print(self.m_textCtrl3.GetValue())
#         ws2 = wb.worksheet(self.m_comboBox1.GetValue())
#         print(self.m_comboBox1.GetValue())
         ws3 = wb.worksheet(self.m_comboBox3.GetStringSelection())
#         print(self.m_comboBox3.GetStringSelection())
         self.row1.SetBackgroundColour('#FFFFFF')
         self.row2.SetBackgroundColour('#FFFFFF')
#         self.m_comboBox1.SetBackgroundColour("#FFFFFF")
         self.m_comboBox3.SetBackgroundColour("#FFFFFF")         
         answer = wx.MessageBox(u'All the data on the selected sheet will be cleared, is that okay?', u'Verification', wx.YES_NO | wx.ICON_EXCLAMATION)
         if answer == wx.NO:
             pass
         elif answer == wx.YES:
          ws3.clear()            
          dlg = wx.ProgressDialog(
            title="ヘッダー取得中",
            message="0/100",
            maximum=100,
            style=wx.PD_AUTO_HIDE | wx.PD_ELAPSED_TIME | wx.PD_ESTIMATED_TIME | wx.PD_REMAINING_TIME )         
         
# ダイアログ表示
          dlg.Show()
          rate = 0

#所要時間計測開始
          start = time.time()

#全国のホームページ制作会社一覧
          for j in tqdm(range(row1, row2+1)):
           driver.get("https://imitsu.jp/ct-hp-design/search/?pn=" + str(j))
#           driver.get(ws2.cell(j,1).value)
           time.sleep(8)
     
           html = driver.page_source
#     print(html)
           soup = BeautifulSoup(html, 'html.parser')

#「〇～○件を表示」
           KEN1 = driver.find_element_by_xpath('//*[@id="top"]/div[3]').text
#     HEN1 = KEN1.replace('件','')
           print(KEN1)

           service_urls = []
           for service_url in soup.select('.imc-color-a.imc-color-a--u'):
            print(service_url.get('href'))
            service_urls.append(service_url.get('href'))

#後で「https://imitsu.jp」と連結させること！！
#           time.sleep(5)
              
#ws1の行数を取得
           lastrow1 = len(ws3.col_values(1))
#           print(lastrow1)       
           
           if lastrow1 == 0:
            cell_list2 = ws3.range(1, 1, str(len(service_urls)), 1)
            time.sleep(5)
#スプレッドシートに入力
            for v2,c2 in zip(service_urls,cell_list2):
             c2.value = v2
            ws3.update_cells(cell_list2)
            
           elif lastrow1 > 0:
            cell_list2 = ws3.range(lastrow1+1, 1, lastrow1+1+len(service_urls), 1)
            time.sleep(5)
            for v2,c2 in zip(service_urls,cell_list2):
             c2.value = v2
            ws3.update_cells(cell_list2)
            
        # ループ処理
#          for a in range(rate, 100):
#          while rate < 100:
            # 0.5秒待つ
#            time.sleep(0.5)
           rate += 1/((row2+1)-row1)*100
            # 値の更新
           dlg.Update(value=rate, newmsg="%d/100" % rate + "%")
           
          dlg.Destroy()

#chromeドライバーの終了
          driver.quit()      

# calculate elapsed time
          elapsed_time = int(time.time() - start)

# convert second to hour, minute and seconds
          elapsed_hour = elapsed_time // 3600
          elapsed_minute = (elapsed_time % 3600) // 60
          elapsed_second = (elapsed_time % 3600 % 60)

# print as 00:00:00
          print("所要時間：" + str(elapsed_hour).zfill(2) + "h" \
      + str(elapsed_minute).zfill(2) + "m" + str(elapsed_second).zfill(2) + "s")        


    def Get_details( self, event ):
        adid = MyProject1MyDialog3(self)
        credentials = ServiceAccountCredentials.from_json_keyfile_name(adid.m_textCtrl11.GetValue(), scope)
        gc = gspread.authorize(credentials)
        row3 = self.row3.GetValue()
        row4 = self.row4.GetValue()
#        print(row3)
#        print(row4)                

        if self.m_comboBox31.GetValue() == '選択して下さい':
         self.m_comboBox31.SetBackgroundColour("#ff0000")      
         wx.MessageBox(u'Please select the Worksheet title!!', u'Setting value error', wx.ICON_ERROR)
        elif not 'リスト' in self.m_comboBox31.GetValue():
         self.m_comboBox31.SetBackgroundColour("#ff0000")         
         wx.MessageBox(u'Not a valid sheet name.!!', u'Setting value error', wx.ICON_ERROR)            
        elif row3 == 0 or row4 == 0:
         self.row3.SetBackgroundColour('#ff0000')
         self.row4.SetBackgroundColour('#ff0000')
         self.m_comboBox31.SetBackgroundColour("#FFFFFF")        
         wx.MessageBox(u'Please set the range!!', u'Setting value error', wx.ICON_ERROR)
        elif row4 - row3 > 10000:
         self.row3.SetBackgroundColour('#ff0000')
         self.row4.SetBackgroundColour('#ff0000')
         self.m_comboBox31.SetBackgroundColour("#FFFFFF")        
         wx.MessageBox(u'The value exceeds the configurable range!!', u'Setting value error', wx.ICON_ERROR)
        elif row4 - row3 < 0:
         self.row3.SetBackgroundColour('#ff0000')
         self.row4.SetBackgroundColour('#ff0000')
         self.m_comboBox31.SetBackgroundColour("#FFFFFF")        
         wx.MessageBox(u'Illegal range!!', u'Setting value error', wx.ICON_ERROR)
		# Set cell values.
        else:
         from selenium import webdriver
         from selenium.webdriver.chrome.options import Options

#例外処理用のlibraryをimport
         from selenium.common.exceptions import NoSuchElementException
         from selenium.common.exceptions import WebDriverException
         from selenium.common.exceptions import TimeoutException

#Selectモジュールをインポート
		 #from selenium.webdriver.support.select import Select

#オプションの作成
         option = Options()

#起動オプション
# ヘッドレスモードを有効にする（次の行をコメントアウトすると画面が表示される）。
         option.add_argument('--headless')

#「unknown error: net::ERR_CONNECTION_CLOSED」の回避用
         option.add_argument('--disable-dev-shm-usage')

# ChromeのWebDriverオブジェクトを作成する。
         driver = webdriver.Chrome(adid.m_textCtrl111.GetValue(),options=option)
         driver.set_page_load_timeout(60)
            
         wb = gc.open_by_key(adid.m_comboBox6.GetValue())
#         print(self.m_textCtrl3.GetValue())
         ws3 = wb.worksheet(self.m_comboBox31.GetStringSelection())
#         print(self.m_comboBox3.GetStringSelection())
         self.row3.SetBackgroundColour('#FFFFFF')
         self.row4.SetBackgroundColour('#FFFFFF')
         self.m_comboBox31.SetBackgroundColour("#FFFFFF")        

        # Set cell values.
#         ws3.clear()
         dlg = wx.ProgressDialog(
            title="会社概要取得中",
            message="0/100",
            maximum=100,
            style=wx.PD_AUTO_HIDE | wx.PD_ELAPSED_TIME | wx.PD_ESTIMATED_TIME | wx.PD_REMAINING_TIME )         
         
# ダイアログ表示
         dlg.Show()
         rate = 0

#所要時間計測開始
         start = time.time()

#会社概要
#ws1の行数を取得
         lastrow1 = len(ws3.col_values(1))
         print(lastrow1)       
         for k in tqdm(range(row3, row4+1)):
              try:
               driver.get('https://imitsu.jp' + ws3.cell(k,1).value)
               time.sleep(5)
               ws3.update_cell(k, 1, driver.current_url)

               if driver.title == 'Error 502 (Server Error)!!1':
                lastcol = len(list(ws3.row_values(k)))                            
                ws3.update_cell(k,lastcol,driver.title)          
                break

               html = driver.page_source
               soup = BeautifulSoup(html, 'html.parser')
#               print(soup)

#エラー発生時に回避（①～⑤は実施されない）
              except WebDriverException:
               break

#①各詳細データ

#１列目
              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(1) > dd"):
               print(Content.getText())
       
#       if "会社名" in Content:           
#       Contents.append(Content.getText())
               time.sleep(3)       
#     for i in range(1,len(Contents)):
               lastcol = len(list(ws3.row_values(k)))                  
#       ws3.update_cell(k, lastcol+1, Contents[i-1])
               Content1 = re.sub("[\n]", "", Content.getText(), 4)
               ws3.update_cell(k, lastcol+1, Content1)

              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(1) > dd"):
               print(Content.getText())
       
#       if "会社名" in Content:           
#       Contents.append(Content.getText())
               time.sleep(3)       
#     for i in range(1,len(Contents)):
               lastcol = len(list(ws3.row_values(k)))                  
#       ws3.update_cell(k, lastcol+1, Contents[i-1])
               Content1 = re.sub("[\n]", "", Content.getText(), 4)
               ws3.update_cell(k, lastcol+1, Content1)

              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(1) > dd"):
               print(Content.getText())
       
#       if "会社名" in Content:           
#       Contents.append(Content.getText())
               time.sleep(3)       
#     for i in range(1,len(Contents)):
               lastcol = len(list(ws3.row_values(k)))                  
#       ws3.update_cell(k, lastcol+1, Contents[i-1])
               Content1 = re.sub("[\n]", "", Content.getText(), 4)
               ws3.update_cell(k, lastcol+1, Content1)


#（テキストパターン１）
#２列目
              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(2) > dt"):
               print(Content.getText())
       
               if "設立年" in Content.getText():
                pass
               elif "資本金" in Content.getText():
                pass    
               elif "従業員" in Content.getText():
                pass    
               elif "住所" in Content.getText():
                for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(2) > dd"):
                 print(Content.getText())
                 time.sleep(3)
                 Content2 = re.sub("[\n]", "", Content.getText(), 4)
                 Content2 = re.sub("[\s]", "", Content2, 34)
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, Content2)

               elif "会社URL" in Content.getText():
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, "-")                   
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, "-")                   

                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(2) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content4 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content4)

#３列目
              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(3) > dt"):
               print(Content.getText())

               if "設立年" in Content.getText():
                pass
               elif "従業員" in Content.getText():
                pass    
               elif "住所" in Content.getText():
                for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(3) > dd"):
                 print(Content.getText())
                 time.sleep(3)               
                 Content2 = re.sub("[\n]", "", Content.getText(), 4)
                 Content2 = re.sub("[\s]", "", Content2, 34)
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, Content2)
                 
               elif "電話番号" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(3) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content3 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content3)
                  
               elif "会社URL" in Content.getText():
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, "-")                                              
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(3) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content4 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content4)

#４列目
              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(4) > dt"):
               print(Content.getText())

               if "従業員" in Content.getText():
                pass    
               elif "住所" in Content.getText():
                for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(4) > dd"):
                 print(Content.getText())
                 time.sleep(3)               
                 Content2 = re.sub("[\n]", "", Content.getText(), 4)
                 Content2 = re.sub("[\s]", "", Content2, 34)
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, Content2)
                 
               elif "電話番号" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(4) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content3 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content3)
                  
               elif "会社URL" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(4) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
#                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content4 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, 5, Content4)

#５列目
              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(5) > dt"):
               print(Content.getText())

               if "会社概要" in Content.getText():
                pass    
               elif "住所" in Content.getText():
                for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(5) > dd"):
                 print(Content.getText())
                 time.sleep(3)               
                 Content2 = re.sub("[\n]", "", Content.getText(), 4)
                 Content2 = re.sub("[\s]", "", Content2, 34)
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, Content2)
                 
               elif "電話番号" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(5) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content3 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content3)
                  
               elif "会社URL" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(5) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
#                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content4 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, 5, Content4)

#６列目
              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(6) > dt"):
               print(Content.getText())

               if "会社概要" in Content.getText():
                pass    
               elif "住所" in Content.getText():
                for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(6) > dd"):
                 print(Content.getText())
                 time.sleep(3)               
                 Content2 = re.sub("[\n]", "", Content.getText(), 4)
                 Content2 = re.sub("[\s]", "", Content2, 34)
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, Content2)
                 
               elif "電話番号" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(6) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content3 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content3)
                  
               elif "会社URL" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(6) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
#                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content4 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, 5, Content4)

#７列目
              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(7) > dt"):
               print(Content.getText())

               if "会社概要" in Content.getText():
                pass    
               elif "住所" in Content.getText():
                for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(7) > dd"):
                 print(Content.getText())
                 time.sleep(3)               
                 Content2 = re.sub("[\n]", "", Content.getText(), 4)
                 Content2 = re.sub("[\s]", "", Content2, 34)
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, Content2)
                 
               elif "電話番号" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(7) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content3 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content3)
                  
               elif "会社URL" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(7) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content4 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content4)

#８列目
              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(8) > dt"):
               print(Content.getText())

               if "会社概要" in Content.getText():
                pass    
               elif "住所" in Content.getText():
                for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(8) > dd"):
                 print(Content.getText())
                 time.sleep(3)               
                 Content2 = re.sub("[\n]", "", Content.getText(), 4)
                 Content2 = re.sub("[\s]", "", Content2, 34)
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, Content2)
                 
               elif "電話番号" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(8) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content3 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content3)
                  
               elif "会社URL" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(4) > div:nth-of-type(2) > dl:nth-of-type(8) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content4 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content4)

                
#（テキストパターン２）
#２列目
              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(2) > dt"):
               print(Content.getText())
       
               if "設立年" in Content.getText():
                pass
               elif "資本金" in Content.getText():
                pass    
               elif "従業員" in Content.getText():
                pass    
               elif "住所" in Content.getText():
                for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(2) > dd"):
                 print(Content.getText())
                 time.sleep(3)
                 Content2 = re.sub("[\n]", "", Content.getText(), 4)
                 Content2 = re.sub("[\s]", "", Content2, 34)
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, Content2)

               elif "会社URL" in Content.getText():
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, "-")                   
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, "-")                   

                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(2) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content4 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content4)

#３列目
              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(3) > dt"):
               print(Content.getText())

               if "設立年" in Content.getText():
                pass
               elif "従業員" in Content.getText():
                pass    
               elif "住所" in Content.getText():
                for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(3) > dd"):
                 print(Content.getText())
                 time.sleep(3)               
                 Content2 = re.sub("[\n]", "", Content.getText(), 4)
                 Content2 = re.sub("[\s]", "", Content2, 34)
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, Content2)
                 
               elif "電話番号" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(3) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content3 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content3)
                  
               elif "会社URL" in Content.getText():
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, "-")                                              
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(3) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content4 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content4)

#４列目
              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(4) > dt"):
               print(Content.getText())

               if "従業員" in Content.getText():
                pass    
               elif "住所" in Content.getText():
                for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(4) > dd"):
                 print(Content.getText())
                 time.sleep(3)               
                 Content2 = re.sub("[\n]", "", Content.getText(), 4)
                 Content2 = re.sub("[\s]", "", Content2, 34)
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, Content2)
                 
               elif "電話番号" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(4) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content3 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content3)
                  
               elif "会社URL" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(4) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
#                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content4 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, 5, Content4)

#５列目
              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(5) > dt"):
               print(Content.getText())

               if "会社概要" in Content.getText():
                pass    
               elif "住所" in Content.getText():
                for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(5) > dd"):
                 print(Content.getText())
                 time.sleep(3)               
                 Content2 = re.sub("[\n]", "", Content.getText(), 4)
                 Content2 = re.sub("[\s]", "", Content2, 34)
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, Content2)
                 
               elif "電話番号" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(5) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content3 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content3)
                  
               elif "会社URL" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(5) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
#                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content4 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, 5, Content4)

#６列目
              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(6) > dt"):
               print(Content.getText())

               if "会社概要" in Content.getText():
                pass    
               elif "住所" in Content.getText():
                for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(6) > dd"):
                 print(Content.getText())
                 time.sleep(3)               
                 Content2 = re.sub("[\n]", "", Content.getText(), 4)
                 Content2 = re.sub("[\s]", "", Content2, 34)
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, Content2)
                 
               elif "電話番号" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(6) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content3 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content3)
                  
               elif "会社URL" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(6) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
#                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content4 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, 5, Content4)

#７列目
              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(7) > dt"):
               print(Content.getText())

               if "会社概要" in Content.getText():
                pass    
               elif "住所" in Content.getText():
                for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(7) > dd"):
                 print(Content.getText())
                 time.sleep(3)               
                 Content2 = re.sub("[\n]", "", Content.getText(), 4)
                 Content2 = re.sub("[\s]", "", Content2, 34)
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, Content2)
                 
               elif "電話番号" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(7) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content3 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content3)
                  
               elif "会社URL" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(7) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content4 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content4)

#８列目
              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(8) > dt"):
               print(Content.getText())

               if "会社概要" in Content.getText():
                pass    
               elif "住所" in Content.getText():
                for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(8) > dd"):
                 print(Content.getText())
                 time.sleep(3)               
                 Content2 = re.sub("[\n]", "", Content.getText(), 4)
                 Content2 = re.sub("[\s]", "", Content2, 34)
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, Content2)
                 
               elif "電話番号" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(8) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content3 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content3)
                  
               elif "会社URL" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(3) > div:nth-of-type(2) > dl:nth-of-type(8) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content4 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content4)


#（テキストパターン３）
#２列目
              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(2) > dt"):
               print(Content.getText())
       
               if "設立年" in Content.getText():
                pass
               elif "資本金" in Content.getText():
                pass    
               elif "従業員" in Content.getText():
                pass    
               elif "住所" in Content.getText():
                for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(2) > dd"):
                 print(Content.getText())
                 time.sleep(3)
                 Content2 = re.sub("[\n]", "", Content.getText(), 4)
                 Content2 = re.sub("[\s]", "", Content2, 34)
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, Content2)

               elif "会社URL" in Content.getText():
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, "-")                   
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, "-")                   

                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(2) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content4 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content4)

#３列目
              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(3) > dt"):
               print(Content.getText())

               if "設立年" in Content.getText():
                pass
               elif "従業員" in Content.getText():
                pass    
               elif "住所" in Content.getText():
                for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(3) > dd"):
                 print(Content.getText())
                 time.sleep(3)               
                 Content2 = re.sub("[\n]", "", Content.getText(), 4)
                 Content2 = re.sub("[\s]", "", Content2, 34)
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, Content2)
                 
               elif "電話番号" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(3) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content3 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content3)
                  
               elif "会社URL" in Content.getText():
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, "-")                                              
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(3) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content4 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content4)

#４列目
              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(4) > dt"):
               print(Content.getText())

               if "従業員" in Content.getText():
                pass    
               elif "住所" in Content.getText():
                for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(4) > dd"):
                 print(Content.getText())
                 time.sleep(3)               
                 Content2 = re.sub("[\n]", "", Content.getText(), 4)
                 Content2 = re.sub("[\s]", "", Content2, 34)
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, Content2)
                 
               elif "電話番号" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(4) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content3 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content3)
                  
               elif "会社URL" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(4) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
#                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content4 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, 5, Content4)

#５列目
              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(5) > dt"):
               print(Content.getText())

               if "会社概要" in Content.getText():
                pass    
               elif "住所" in Content.getText():
                for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(5) > dd"):
                 print(Content.getText())
                 time.sleep(3)               
                 Content2 = re.sub("[\n]", "", Content.getText(), 4)
                 Content2 = re.sub("[\s]", "", Content2, 34)
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, Content2)
                 
               elif "電話番号" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(5) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content3 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content3)
                  
               elif "会社URL" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(5) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
#                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content4 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, 5, Content4)

#６列目
              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(6) > dt"):
               print(Content.getText())

               if "会社概要" in Content.getText():
                pass    
               elif "住所" in Content.getText():
                for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(6) > dd"):
                 print(Content.getText())
                 time.sleep(3)               
                 Content2 = re.sub("[\n]", "", Content.getText(), 4)
                 Content2 = re.sub("[\s]", "", Content2, 34)
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, Content2)
                 
               elif "電話番号" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(6) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content3 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content3)
                  
               elif "会社URL" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(6) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
#                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content4 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, 5, Content4)

#７列目
              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(7) > dt"):
               print(Content.getText())

               if "会社概要" in Content.getText():
                pass    
               elif "住所" in Content.getText():
                for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(7) > dd"):
                 print(Content.getText())
                 time.sleep(3)               
                 Content2 = re.sub("[\n]", "", Content.getText(), 4)
                 Content2 = re.sub("[\s]", "", Content2, 34)
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, Content2)
                 
               elif "電話番号" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(7) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content3 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content3)
                  
               elif "会社URL" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(7) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content4 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content4)

#８列目
              for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(8) > dt"):
               print(Content.getText())

               if "会社概要" in Content.getText():
                pass    
               elif "住所" in Content.getText():
                for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(8) > dd"):
                 print(Content.getText())
                 time.sleep(3)               
                 Content2 = re.sub("[\n]", "", Content.getText(), 4)
                 Content2 = re.sub("[\s]", "", Content2, 34)
                 lastcol = len(list(ws3.row_values(k)))                                  
                 ws3.update_cell(k, lastcol+1, Content2)
                 
               elif "電話番号" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(8) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content3 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content3)
                  
               elif "会社URL" in Content.getText():
                 for Content in soup.select("body > div:nth-of-type(3) > div \
> article > section:nth-of-type(2) > div:nth-of-type(2) > dl:nth-of-type(8) > dd"):
                  print(Content.getText())
                  time.sleep(3)               
                  lastcol = len(list(ws3.row_values(k)))                                  
                  Content4 = re.sub("[\n]", "", Content.getText(), 4)
                  ws3.update_cell(k, lastcol+1, Content4)

#Progressbar                
              rate += 1/((row4+1)-row3)*100
            # 値の更新
              dlg.Update(value=rate, newmsg="%d/100" % rate + "%")
           
         dlg.Destroy()

#chromeドライバーの終了
         driver.quit()      

# calculate elapsed time
         elapsed_time = int(time.time() - start)

# convert second to hour, minute and seconds
         elapsed_hour = elapsed_time // 3600
         elapsed_minute = (elapsed_time % 3600) // 60
         elapsed_second = (elapsed_time % 3600 % 60)

# print as 00:00:00
         print("所要時間：" + str(elapsed_hour).zfill(2) + "h" \
      + str(elapsed_minute).zfill(2) + "m" + str(elapsed_second).zfill(2) + "s")


    def quit_button( self, event ):
		# TODO: Implement quit_button
#        self.parent.tableShow()
	    self.Destroy()

    def page_list( self, event ):

#MyDialogの各設定値をMyFrame4に受け渡し
          adid = MyProject1MyFrame4(self)
          adid.grid.ClearGrid()
#          i = 0
          lastrow = 391
          dlg = wx.ProgressDialog(
            title="リスト取得中",
            message="0/100",
            maximum=100,
            style=wx.PD_AUTO_HIDE | wx.PD_ELAPSED_TIME | wx.PD_ESTIMATED_TIME | wx.PD_REMAINING_TIME )         
         
# ダイアログ表示
          dlg.Show()
          rate = 0
          
          for row in range(lastrow+1):
            adid.grid.SetCellValue(row, 0, "https://imitsu.jp/ct-hp-design/search/?pn=" + str(row+1))
#            print("https://imitsu.jp/ct-hp-design/search/?pn=" + str(row+1))
#            print(cell_list1[i].value)
#            adid.grid.SetCellValue(row, 0, cell_list1[i].value)
#            i += 1
            rate += 1/(lastrow+1)*100
            # 値の更新
            dlg.Update(value=rate, newmsg="%d/100" % rate + "%")
 
          adid.grid.AutoSize()
          adid.Show()
          dlg.Destroy()
          
    def list_view( self, event ):
        adid = MyProject1MyDialog3(self)
        credentials = ServiceAccountCredentials.from_json_keyfile_name(adid.m_textCtrl11.GetValue(), scope)
        gc = gspread.authorize(credentials)                   

        if self.m_comboBox11.GetValue() == '選択して下さい':
         self.m_comboBox11.SetBackgroundColour("#ff0000")
         wx.MessageBox(u'Please select the Worksheet title!!', u'Setting value error', wx.ICON_ERROR)
        elif not 'リスト' in self.m_comboBox11.GetValue():
         self.m_comboBox11.SetBackgroundColour("#FFFFFF")
         wx.MessageBox(u'The selected sheet name is not valid.!!', u'Setting value error', wx.ICON_ERROR)
		# Set cell values.
        else:
         wb = gc.open_by_key(adid.m_comboBox6.GetValue())
         ws3 = wb.worksheet(self.m_comboBox11.GetValue())
         lastrow = len(ws3.col_values(1))         
         self.m_comboBox11.SetBackgroundColour("#FFFFFF")
         
#MyDialogの各設定値をMyFrame5に受け渡し
         adid = MyProject1MyFrame5(self)
#         adid.InitializeComponents(self.m_textCtrl3.GetValue())
#         adid.InitializeComponents(self.m_comboBox11.GetValue())
         adid.grid.ClearGrid()
#         self.m_gauge2.SetValue( 0 )         
#         self.m_gauge2.SetRange(row2-row1) 
         dlg = wx.ProgressDialog(
            title="リスト取得中",
            message="0/100",
            maximum=100,
            style=wx.PD_AUTO_HIDE | wx.PD_ELAPSED_TIME | wx.PD_ESTIMATED_TIME | wx.PD_REMAINING_TIME )         
         
# ダイアログ表示
         dlg.Show()
         rate = 0

         cell_list1 = ws3.range(1, 1, lastrow, 1)
         cell_list2 = ws3.range(1, 2, lastrow, 2)
         cell_list3 = ws3.range(1, 3, lastrow, 3)
         cell_list4 = ws3.range(1, 4, lastrow, 4)
         cell_list5 = ws3.range(1, 5, lastrow, 5)
         cell_list6 = ws3.range(1, 6, lastrow, 6)         
#		i = 0
#		for row in range(row1, row2):
         i = 0
         for row in range(lastrow):
            adid.grid.SetCellValue(row, 0, cell_list1[i].value)
            adid.grid.SetCellValue(row, 1, cell_list2[i].value)
            adid.grid.SetCellValue(row, 2, cell_list3[i].value)
            adid.grid.SetCellValue(row, 3, cell_list4[i].value)
            adid.grid.SetCellValue(row, 4, cell_list5[i].value)
            adid.grid.SetCellValue(row, 5, cell_list6[i].value)
#            print(cell_list1[i].value)
#            print(cell_list2[i].value)
#            print(cell_list3[i].value)
#            print(cell_list4[i].value)
#            print(cell_list5[i].value)
#            print(cell_list6[i].value)
            i += 1
            rate += 1/(lastrow+1)*100
            # 値の更新
            dlg.Update(value=rate, newmsg="%d/100" % rate + "%")
           
         dlg.Destroy()
            
#            count = self.m_gauge2.GetValue() + 1
#            if count > row2-row1:
#             count = 0
#            else:
#             self.m_gauge2.SetValue(count)
#		    row1 += 1
         adid.grid.AutoSize()
         adid.Show()


class MyProject1MyDialog3( app.MyDialog3 ):
    def __init__(self, parent):
        app.MyDialog3.__init__(self, parent)
        self.parent = parent
 
        hbox4 = wx.BoxSizer( wx.VERTICAL )

        self.m_panel22 = wx.Panel( self, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_panel22.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        sbSizer151 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel22, wx.ID_ANY, u"Required information" ), wx.VERTICAL )

        self.m_panel161 = wx.Panel( sbSizer151.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_panel161.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        sbSizer141 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel161, wx.ID_ANY, u"Google API service account verification key" ), wx.VERTICAL )

        self.m_textCtrl11 = wx.TextCtrl( sbSizer141.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        
# ドロップ対象の設定
        self.m_textCtrl11.SetDropTarget(FileDropTarget1(self))
        
#ツールチップ（補足情報を載せる小さいウィンドウ）を表示
        self.m_textCtrl11.SetToolTip("Please drag and drop the JSON file into this text box.")
        
        sbSizer141.Add( self.m_textCtrl11, 0, wx.ALL, 5 )


        self.m_panel161.SetSizer( sbSizer141 )
        self.m_panel161.Layout()
        sbSizer141.Fit( self.m_panel161 )
        sbSizer151.Add( self.m_panel161, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel16 = wx.Panel( sbSizer151.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_panel16.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        sbSizer14 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel16, wx.ID_ANY, u"Google spreadsheet key" ), wx.VERTICAL )

        m_comboBox6Choices = ['1BazsXmS9dW8oAOmvjMNVabvvw1dYAgW9SR-qbyAylEU']
        self.m_comboBox6 = wx.ComboBox( sbSizer14.GetStaticBox(), wx.ID_ANY, u"選択して下さい", wx.DefaultPosition, wx.Size( 400,-1 ), m_comboBox6Choices, 0 )

#コンボボックスの項目が選択されたときに処理するイベントをtext_event()メソッドに関連付けるバインダーを設定
#        self.m_comboBox6.Bind(wx.EVT_COMBOBOX, self.text_event)

        sbSizer14.Add( self.m_comboBox6, 0, wx.ALL, 5 )


        self.m_panel16.SetSizer( sbSizer14 )
        self.m_panel16.Layout()
        sbSizer14.Fit( self.m_panel16 )
        sbSizer151.Add( self.m_panel16, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel162 = wx.Panel( sbSizer151.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_panel162.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        sbSizer142 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel162, wx.ID_ANY, u"Web driver file for Google Chrome" ), wx.VERTICAL )

        self.m_textCtrl111 = wx.TextCtrl( sbSizer142.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
 
# ドロップ対象の設定
        self.m_textCtrl111.SetDropTarget(FileDropTarget2(self))
        
#ツールチップ（補足情報を載せる小さいウィンドウ）を表示
        self.m_textCtrl111.SetToolTip("Please drag and drop the webdriver file into this text box.")
    
        sbSizer142.Add( self.m_textCtrl111, 0, wx.ALL, 5 )


        self.m_panel162.SetSizer( sbSizer142 )
        self.m_panel162.Layout()
        sbSizer142.Fit( self.m_panel162 )
        sbSizer151.Add( self.m_panel162, 1, wx.EXPAND |wx.ALL, 5 )


        self.m_panel22.SetSizer( sbSizer151 )
        self.m_panel22.Layout()
        sbSizer151.Fit( self.m_panel22 )
        hbox4.Add( self.m_panel22, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel27 = wx.Panel( self, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_panel27.SetFont( wx.Font( 10, wx.FONTFAMILY_MODERN, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        sbSizer17 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel27, wx.ID_ANY, u"Your account information." ), wx.VERTICAL )

        self.m_panel20 = wx.Panel( sbSizer17.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_panel20.SetFont( wx.Font( 10, wx.FONTFAMILY_MODERN, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        sbSizer15 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel20, wx.ID_ANY, u"Username" ), wx.VERTICAL )

        self.m_textCtrl4 = wx.TextCtrl( sbSizer15.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 200,-1 ), 0 )
        sbSizer15.Add( self.m_textCtrl4, 0, wx.ALL, 5 )


        self.m_panel20.SetSizer( sbSizer15 )
        self.m_panel20.Layout()
        sbSizer15.Fit( self.m_panel20 )
        sbSizer17.Add( self.m_panel20, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel21 = wx.Panel( sbSizer17.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_panel21.SetFont( wx.Font( 10, wx.FONTFAMILY_MODERN, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        sbSizer16 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel21, wx.ID_ANY, u"Password" ), wx.VERTICAL )

        self.m_textCtrl5 = wx.TextCtrl( sbSizer16.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 200,-1 ), wx.TE_PASSWORD )
        sbSizer16.Add( self.m_textCtrl5, 0, wx.ALL, 5 )


        self.m_panel21.SetSizer( sbSizer16 )
        self.m_panel21.Layout()
        sbSizer16.Fit( self.m_panel21 )
        sbSizer17.Add( self.m_panel21, 1, wx.EXPAND |wx.ALL, 5 )


        self.m_panel27.SetSizer( sbSizer17 )
        self.m_panel27.Layout()
        sbSizer17.Fit( self.m_panel27 )
        hbox4.Add( self.m_panel27, 1, wx.EXPAND |wx.ALL, 5 )

        self.btn11 = wx.Button( self, wx.ID_ANY, u"Save", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.btn11.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        hbox4.Add( self.btn11, 0, wx.ALL, 5 )


        self.SetSizer( hbox4 )
        self.Layout()

        self.Centre( wx.BOTH )

# Connect Events
        self.btn11.Bind( wx.EVT_BUTTON, self.write )
        self.Bind( wx.EVT_CLOSE, self.quit_button )


#設定情報（json）読み込み
#文字コードをUTF-8に変換しないとエラーが発生するため注意！！
        with codecs.open('setting.json','r',encoding='utf-8') as f:
#「JSONDecodeError: Invalid control character at」が返さないようにする。
#strictがfalse（デフォルトはTrue）の場合、制御文字を文字列に含めることができます。
#ここで言う制御文字とは、'\t'（タブ）、'\n'、'\r'、'\0'を含む0-31の範囲のコードを持つ文字のことです。
            j = json.load(f,strict=False)
#            print(j)
            f.close()
            self.m_textCtrl11.SetValue(j['verificationkey'])
            self.m_comboBox6.SetValue(j['spreadsheetkey'])
            self.m_textCtrl111.SetValue(j['webdriver'])
            self.m_textCtrl4.SetValue(j['user'])
            self.m_textCtrl5.SetValue(j['password'])

#設定情報（json）書き出し
    def write(self, event):
            if not self.m_comboBox6.GetValue() == '1BazsXmS9dW8oAOmvjMNVabvvw1dYAgW9SR-qbyAylEU' \
                or self.m_textCtrl11.GetValue() == '1BazsXmS9dW8oAOmvjMNVabvvw1dYAgW9SR-qbyAylEU' \
                    or not 'json' in self.m_textCtrl11.GetValue() \
                        or not 'chromedriver.exe' in self.m_textCtrl111.GetValue():
              self.m_comboBox6.SetBackgroundColour('#f56cbe')
              self.m_textCtrl11.SetBackgroundColour('#f56cbe')          
#	      self.m_textCtrl111.SetForegroundColour('#f56cbe')
              wx.MessageBox(u'The key is incorrect or does not exist!!', u'Setting value error', wx.ICON_ERROR)
            elif not 'chromedriver.exe' in self.m_textCtrl111.GetValue():
              self.m_textCtrl111.SetBackgroundColour('#f56cbe')
              wx.MessageBox(u'The web driver file is not set or the file path does not pass!!', u'Setting value error', wx.ICON_ERROR)
            elif self.m_textCtrl4.GetValue() == "" \
                or self.m_textCtrl5.GetValue() == "":
              self.m_textCtrl4.SetBackgroundColour('#f56cbe')
              self.m_textCtrl5.SetBackgroundColour('#f56cbe')
              wx.MessageBox(u'No user name or password has been entered!!', u'Setting value error', wx.ICON_ERROR)
            else:
              self.m_comboBox6.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl11.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl111.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl4.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl5.SetBackgroundColour('#FFFFFF')

#文字コードをUTF-8に変換しないとエラー発生がするため注意！！
              with open('setting.json','w',encoding='utf-8') as f:
                w_data = {}
                w_data['verificationkey'] = self.m_textCtrl11.GetValue()
                w_data['spreadsheetkey'] = self.m_comboBox6.GetValue()
                w_data['webdriver'] = self.m_textCtrl111.GetValue()
                w_data['user'] = self.m_textCtrl4.GetValue()
                w_data['password'] = self.m_textCtrl5.GetValue()
                json.dump(w_data, f, ensure_ascii=False, indent=1, sort_keys=True, separators=(',', ': '))
                print('WRITE:')
 #               print(w_data)
                self.Destroy()
        
    def quit_button( self, event ):
		# TODO: Implement quit_button
        self.Destroy()

#Profile
class MyProject1MyDialog4( app.MyDialog4 ):
    def __init__(self, parent):
        app.MyDialog4.__init__(self, parent)
        self.parent = parent

        hbox4 = wx.BoxSizer( wx.VERTICAL )

#Corporate_infomation
        self.m_notebook1 = wx.Notebook( self, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_notebook1.SetFont( wx.Font( 10, wx.FONTFAMILY_MODERN, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        self.m_panel46 = wx.Panel( self.m_notebook1, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer50 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel46, wx.ID_ANY, u"Corporate infomation" ), wx.VERTICAL )

        gSizer72 = wx.GridSizer( 0, 2, 0, 0 )

        gSizer73 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel47 = wx.Panel( sbSizer50.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_panel47.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        sbSizer51 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel47, wx.ID_ANY, u"Company name" ), wx.VERTICAL )

        self.m_textCtrl11 = wx.TextCtrl( sbSizer51.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer51.Add( self.m_textCtrl11, 0, wx.ALL, 5 )


        self.m_panel47.SetSizer( sbSizer51 )
        self.m_panel47.Layout()
        sbSizer51.Fit( self.m_panel47 )
        gSizer73.Add( self.m_panel47, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel48 = wx.Panel( sbSizer50.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer52 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel48, wx.ID_ANY, u"Hiragana" ), wx.VERTICAL )

        self.m_textCtrl12 = wx.TextCtrl( sbSizer52.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer52.Add( self.m_textCtrl12, 0, wx.ALL, 5 )


        self.m_panel48.SetSizer( sbSizer52 )
        self.m_panel48.Layout()
        sbSizer52.Fit( self.m_panel48 )
        gSizer73.Add( self.m_panel48, 1, wx.EXPAND |wx.ALL, 5 )


        gSizer72.Add( gSizer73, 1, wx.EXPAND, 5 )

        gSizer74 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel49 = wx.Panel( sbSizer50.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer53 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel49, wx.ID_ANY, u"Katakana" ), wx.VERTICAL )

        self.m_textCtrl13 = wx.TextCtrl( sbSizer53.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer53.Add( self.m_textCtrl13, 0, wx.ALL, 5 )


        self.m_panel49.SetSizer( sbSizer53 )
        self.m_panel49.Layout()
        sbSizer53.Fit( self.m_panel49 )
        gSizer74.Add( self.m_panel49, 1, wx.EXPAND |wx.ALL, 5 )


        gSizer72.Add( gSizer74, 1, wx.EXPAND, 5 )


        sbSizer50.Add( gSizer72, 1, wx.EXPAND, 5 )

        gSizer75 = wx.GridSizer( 0, 2, 0, 0 )

        gSizer76 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel50 = wx.Panel( sbSizer50.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer54 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel50, wx.ID_ANY, u"Industry" ), wx.VERTICAL )

#業種をリストへ格納
        m_comboBox61Choices = ('IT・通信・インターネット',
                               'マスコミ・メディア',
                               '新聞・雑誌・出版',
                               '広告・イベント・プロモーション',
                               '芸能・エンターテイメント',
                               'ゲーム・アニメ・玩具',
                               '恋愛・出会い・占い',
                               '婚活・ブライダル',
                               '動物・ペット',
                               '生花・園芸・造園',
                               '美術・工芸・音楽',
                               'スポーツ・フィットネス',
                               '自動車・バイク',
                               '旅行・観光・グルメ',
                               'ホテル・旅館・民泊',
                               'メーカー',
                               '商社',
                               '流通・運輸・交通',
                               '工業・製造',
                               '卸売・小売',
                               'ファッション・アパレル',
                               '家具・インテリア',
                               '食品・飲料・たばこ',
                               '医療・医薬',
                               '介護・福祉',
                               '家事代行',
                               '葬祭',
                               '金融・保険',
                               '住宅・不動産',
                               '建築・工務店',
                               '店舗（飲食店・居酒屋など）',
                               '美容室・サロン',
                               '資格・習い事',
                               '保育園・幼稚園',
                               '塾・予備校',
                               '大学・学校',
                               '学術・研究',
                               'リサーチ・調査',
                               'コンサルティング・シンクタンク',
                               '士業（個人事務所）',
                               '人材紹介・人材派遣',
                               '翻訳・通訳',
                               'エネルギー（電気・ガス・水道など）',
                               '農林・水産・鉱業',
                               '清掃・設備・警備',
                               '公益・非営利団体',
                               '官公庁・自治体',
                               '政治',
                               '宗教')
#        print(m_comboBox61Choices)
        self.m_comboBox61 = wx.ComboBox( sbSizer54.GetStaticBox(), wx.ID_ANY, u"選択して下さい", wx.DefaultPosition, wx.Size( 400,-1 ), m_comboBox61Choices, 0 )
        sbSizer54.Add( self.m_comboBox61, 0, wx.ALL, 5 )


        self.m_panel50.SetSizer( sbSizer54 )
        self.m_panel50.Layout()
        sbSizer54.Fit( self.m_panel50 )
        gSizer76.Add( self.m_panel50, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel51 = wx.Panel( sbSizer50.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer55 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel51, wx.ID_ANY, u"Business content" ), wx.VERTICAL )

        self.m_textCtrl14 = wx.TextCtrl( sbSizer55.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer55.Add( self.m_textCtrl14, 0, wx.ALL, 5 )


        self.m_panel51.SetSizer( sbSizer55 )
        self.m_panel51.Layout()
        sbSizer55.Fit( self.m_panel51 )
        gSizer76.Add( self.m_panel51, 1, wx.EXPAND |wx.ALL, 5 )


        gSizer75.Add( gSizer76, 1, wx.EXPAND, 5 )

        gSizer77 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel52 = wx.Panel( sbSizer50.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        gSizer77.Add( self.m_panel52, 1, wx.EXPAND |wx.ALL, 5 )


        gSizer75.Add( gSizer77, 1, wx.EXPAND, 5 )


        sbSizer50.Add( gSizer75, 1, wx.EXPAND, 5 )


        self.m_panel46.SetSizer( sbSizer50 )
        self.m_panel46.Layout()
        sbSizer50.Fit( self.m_panel46 )
        self.m_notebook1.AddPage( self.m_panel46, u"Corporate_infomation", False )
        
#Sender        
        self.m_panel531 = wx.Panel( self.m_notebook1, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer56 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel531, wx.ID_ANY, u"Sender" ), wx.VERTICAL )

        gSizer78 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel53 = wx.Panel( sbSizer56.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer57 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel53, wx.ID_ANY, u"Kanji full" ), wx.VERTICAL )

        self.m_textCtrl15 = wx.TextCtrl( sbSizer57.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer57.Add( self.m_textCtrl15, 0, wx.ALL, 5 )


        self.m_panel53.SetSizer( sbSizer57 )
        self.m_panel53.Layout()
        sbSizer57.Fit( self.m_panel53 )
        gSizer78.Add( self.m_panel53, 1, wx.EXPAND |wx.ALL, 5 )

        gSizer79 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel54 = wx.Panel( sbSizer56.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer58 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel54, wx.ID_ANY, u"Sei" ), wx.VERTICAL )

        self.m_textCtrl16 = wx.TextCtrl( sbSizer58.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer58.Add( self.m_textCtrl16, 0, wx.ALL, 5 )


        self.m_panel54.SetSizer( sbSizer58 )
        self.m_panel54.Layout()
        sbSizer58.Fit( self.m_panel54 )
        gSizer79.Add( self.m_panel54, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel55 = wx.Panel( sbSizer56.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer59 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel55, wx.ID_ANY, u"Mei" ), wx.VERTICAL )

        self.m_textCtrl17 = wx.TextCtrl( sbSizer59.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer59.Add( self.m_textCtrl17, 0, wx.ALL, 5 )


        self.m_panel55.SetSizer( sbSizer59 )
        self.m_panel55.Layout()
        sbSizer59.Fit( self.m_panel55 )
        gSizer79.Add( self.m_panel55, 1, wx.EXPAND |wx.ALL, 5 )


        gSizer78.Add( gSizer79, 1, wx.EXPAND, 5 )


        sbSizer56.Add( gSizer78, 1, wx.EXPAND, 5 )

        gSizer80 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel56 = wx.Panel( sbSizer56.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer60 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel56, wx.ID_ANY, u"Hiragana full" ), wx.VERTICAL )

        self.m_textCtrl18 = wx.TextCtrl( sbSizer60.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer60.Add( self.m_textCtrl18, 0, wx.ALL, 5 )


        self.m_panel56.SetSizer( sbSizer60 )
        self.m_panel56.Layout()
        sbSizer60.Fit( self.m_panel56 )
        gSizer80.Add( self.m_panel56, 1, wx.EXPAND |wx.ALL, 5 )

        gSizer81 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel57 = wx.Panel( sbSizer56.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer61 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel57, wx.ID_ANY, u"Sei" ), wx.VERTICAL )

        self.m_textCtrl19 = wx.TextCtrl( sbSizer61.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer61.Add( self.m_textCtrl19, 0, wx.ALL, 5 )


        self.m_panel57.SetSizer( sbSizer61 )
        self.m_panel57.Layout()
        sbSizer61.Fit( self.m_panel57 )
        gSizer81.Add( self.m_panel57, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel58 = wx.Panel( sbSizer56.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer62 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel58, wx.ID_ANY, u"Mei" ), wx.VERTICAL )

        self.m_textCtrl20 = wx.TextCtrl( sbSizer62.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer62.Add( self.m_textCtrl20, 0, wx.ALL, 5 )


        self.m_panel58.SetSizer( sbSizer62 )
        self.m_panel58.Layout()
        sbSizer62.Fit( self.m_panel58 )
        gSizer81.Add( self.m_panel58, 1, wx.EXPAND |wx.ALL, 5 )


        gSizer80.Add( gSizer81, 1, wx.EXPAND, 5 )


        sbSizer56.Add( gSizer80, 1, wx.EXPAND, 5 )

        gSizer82 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel59 = wx.Panel( sbSizer56.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer63 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel59, wx.ID_ANY, u"Katakana full" ), wx.VERTICAL )

        self.m_textCtrl21 = wx.TextCtrl( sbSizer63.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer63.Add( self.m_textCtrl21, 0, wx.ALL, 5 )


        self.m_panel59.SetSizer( sbSizer63 )
        self.m_panel59.Layout()
        sbSizer63.Fit( self.m_panel59 )
        gSizer82.Add( self.m_panel59, 1, wx.EXPAND |wx.ALL, 5 )

        gSizer83 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel60 = wx.Panel( sbSizer56.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer64 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel60, wx.ID_ANY, u"Sei" ), wx.VERTICAL )

        self.m_textCtrl22 = wx.TextCtrl( sbSizer64.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer64.Add( self.m_textCtrl22, 0, wx.ALL, 5 )


        self.m_panel60.SetSizer( sbSizer64 )
        self.m_panel60.Layout()
        sbSizer64.Fit( self.m_panel60 )
        gSizer83.Add( self.m_panel60, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel61 = wx.Panel( sbSizer56.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer65 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel61, wx.ID_ANY, u"Mei" ), wx.VERTICAL )

        self.m_textCtrl23 = wx.TextCtrl( sbSizer65.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer65.Add( self.m_textCtrl23, 0, wx.ALL, 5 )


        self.m_panel61.SetSizer( sbSizer65 )
        self.m_panel61.Layout()
        sbSizer65.Fit( self.m_panel61 )
        gSizer83.Add( self.m_panel61, 1, wx.EXPAND |wx.ALL, 5 )


        gSizer82.Add( gSizer83, 1, wx.EXPAND, 5 )


        sbSizer56.Add( gSizer82, 1, wx.EXPAND, 5 )

        gSizer84 = wx.GridSizer( 0, 2, 0, 0 )

        gSizer85 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel62 = wx.Panel( sbSizer56.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer66 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel62, wx.ID_ANY, u"Department name" ), wx.VERTICAL )

        self.m_textCtrl24 = wx.TextCtrl( sbSizer66.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 200,-1 ), 0 )
        sbSizer66.Add( self.m_textCtrl24, 0, wx.ALL, 5 )


        self.m_panel62.SetSizer( sbSizer66 )
        self.m_panel62.Layout()
        sbSizer66.Fit( self.m_panel62 )
        gSizer85.Add( self.m_panel62, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel63 = wx.Panel( sbSizer56.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer67 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel63, wx.ID_ANY, u"Official position" ), wx.VERTICAL )

        self.m_textCtrl25 = wx.TextCtrl( sbSizer67.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 200,-1 ), 0 )
        sbSizer67.Add( self.m_textCtrl25, 0, wx.ALL, 5 )


        self.m_panel63.SetSizer( sbSizer67 )
        self.m_panel63.Layout()
        sbSizer67.Fit( self.m_panel63 )
        gSizer85.Add( self.m_panel63, 1, wx.EXPAND |wx.ALL, 5 )


        gSizer84.Add( gSizer85, 1, wx.EXPAND, 5 )

        gSizer86 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel64 = wx.Panel( sbSizer56.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer68 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel64, wx.ID_ANY, u"Age" ), wx.VERTICAL )

        self.m_textCtrl26 = wx.TextCtrl( sbSizer68.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 200,-1 ), 0 )
        sbSizer68.Add( self.m_textCtrl26, 0, wx.ALL, 5 )


        self.m_panel64.SetSizer( sbSizer68 )
        self.m_panel64.Layout()
        sbSizer68.Fit( self.m_panel64 )
        gSizer86.Add( self.m_panel64, 1, wx.EXPAND |wx.ALL, 5 )


        gSizer84.Add( gSizer86, 1, wx.EXPAND, 5 )


        sbSizer56.Add( gSizer84, 1, wx.EXPAND, 5 )


        self.m_panel531.SetSizer( sbSizer56 )
        self.m_panel531.Layout()
        sbSizer56.Fit( self.m_panel531 )
        self.m_notebook1.AddPage( self.m_panel531, u"Sender", True )

#Location
        self.m_panel65 = wx.Panel( self.m_notebook1, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer69 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel65, wx.ID_ANY, u"Location" ), wx.VERTICAL )

        self.m_panel66 = wx.Panel( sbSizer69.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        gSizer87 = wx.GridSizer( 0, 2, 0, 0 )

        sbSizer70 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel66, wx.ID_ANY, u"Postcode" ), wx.VERTICAL )

        gSizer88 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel67 = wx.Panel( sbSizer70.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer71 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel67, wx.ID_ANY, u"Hyphen included" ), wx.VERTICAL )

        self.m_textCtrl27 = wx.TextCtrl( sbSizer71.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer71.Add( self.m_textCtrl27, 0, wx.ALL, 5 )


        self.m_panel67.SetSizer( sbSizer71 )
        self.m_panel67.Layout()
        sbSizer71.Fit( self.m_panel67 )
        gSizer88.Add( self.m_panel67, 1, wx.EXPAND |wx.ALL, 5 )

        gSizer89 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel68 = wx.Panel( sbSizer70.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer72 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel68, wx.ID_ANY, u"Num1" ), wx.VERTICAL )

        self.m_textCtrl28 = wx.TextCtrl( sbSizer72.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer72.Add( self.m_textCtrl28, 0, wx.ALL, 5 )


        self.m_panel68.SetSizer( sbSizer72 )
        self.m_panel68.Layout()
        sbSizer72.Fit( self.m_panel68 )
        gSizer89.Add( self.m_panel68, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel69 = wx.Panel( sbSizer70.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer73 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel69, wx.ID_ANY, u"Num2" ), wx.VERTICAL )

        self.m_textCtrl29 = wx.TextCtrl( sbSizer73.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer73.Add( self.m_textCtrl29, 0, wx.ALL, 5 )


        self.m_panel69.SetSizer( sbSizer73 )
        self.m_panel69.Layout()
        sbSizer73.Fit( self.m_panel69 )
        gSizer89.Add( self.m_panel69, 1, wx.EXPAND |wx.ALL, 5 )


        gSizer88.Add( gSizer89, 1, wx.EXPAND, 5 )


        sbSizer70.Add( gSizer88, 1, wx.EXPAND, 5 )


        gSizer87.Add( sbSizer70, 1, wx.EXPAND, 5 )


        self.m_panel66.SetSizer( gSizer87 )
        self.m_panel66.Layout()
        gSizer87.Fit( self.m_panel66 )
        sbSizer69.Add( self.m_panel66, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel70 = wx.Panel( sbSizer69.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer74 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel70, wx.ID_ANY, u"Detail" ), wx.VERTICAL )

        gSizer90 = wx.GridSizer( 0, 2, 0, 0 )

        gSizer91 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel71 = wx.Panel( sbSizer74.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer75 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel71, wx.ID_ANY, u"Prefecture" ), wx.VERTICAL )

#都道府県をリストへ格納
        m_comboBox6Choices = ('北海道',
                               '青森県',
                               '岩手県',
                               '宮城県',
                               '秋田県',
                               '山形県',
                               '福島県',
                               '茨城県',
                               '栃木県',
                               '群馬県',
                               '埼玉県',
                               '千葉県',
                               '東京都',
                               '神奈川県',
                               '新潟県',
                               '富山県',
                               '石川県',
                               '福井県',
                               '山梨県',
                               '長野県',
                               '岐阜県',
                               '静岡県',
                               '愛知県',
                               '三重県',
                               '滋賀県',
                               '京都府',
                               '大阪府',
                               '兵庫県',
                               '奈良県',
                               '和歌山県',
                               '鳥取県',
                               '島根県',
                               '岡山県',
                               '広島県',
                               '山口県',
                               '徳島県',
                               '香川県',
                               '愛媛県',
                               '高知県',
                               '福岡県',
                               '佐賀県',
                               '長崎県',
                               '熊本県',
                               '大分県',
                               '宮崎県',
                               '鹿児島県',
                               '沖縄県')
#        print(m_comboBox6Choices)
        self.m_comboBox6 = wx.ComboBox( sbSizer75.GetStaticBox(), wx.ID_ANY, u"選択して下さい", wx.DefaultPosition, wx.Size( 400,-1 ), m_comboBox6Choices, 0 )
        sbSizer75.Add( self.m_comboBox6, 0, wx.ALL, 5 )


        self.m_panel71.SetSizer( sbSizer75 )
        self.m_panel71.Layout()
        sbSizer75.Fit( self.m_panel71 )
        gSizer91.Add( self.m_panel71, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel72 = wx.Panel( sbSizer74.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer76 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel72, wx.ID_ANY, u"Municipalities" ), wx.VERTICAL )

        self.m_textCtrl30 = wx.TextCtrl( sbSizer76.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 200,-1 ), 0 )
        sbSizer76.Add( self.m_textCtrl30, 0, wx.ALL, 5 )


        self.m_panel72.SetSizer( sbSizer76 )
        self.m_panel72.Layout()
        sbSizer76.Fit( self.m_panel72 )
        gSizer91.Add( self.m_panel72, 1, wx.EXPAND |wx.ALL, 5 )


        gSizer90.Add( gSizer91, 1, wx.EXPAND, 5 )

        gSizer92 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel73 = wx.Panel( sbSizer74.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer77 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel73, wx.ID_ANY, u"address" ), wx.VERTICAL )

        self.m_textCtrl31 = wx.TextCtrl( sbSizer77.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 200,-1 ), 0 )
        sbSizer77.Add( self.m_textCtrl31, 0, wx.ALL, 5 )


        self.m_panel73.SetSizer( sbSizer77 )
        self.m_panel73.Layout()
        sbSizer77.Fit( self.m_panel73 )
        gSizer92.Add( self.m_panel73, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel74 = wx.Panel( sbSizer74.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer78 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel74, wx.ID_ANY, u"Building" ), wx.VERTICAL )

        self.m_textCtrl32 = wx.TextCtrl( sbSizer78.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 200,-1 ), 0 )
        sbSizer78.Add( self.m_textCtrl32, 0, wx.ALL, 5 )


        self.m_panel74.SetSizer( sbSizer78 )
        self.m_panel74.Layout()
        sbSizer78.Fit( self.m_panel74 )
        gSizer92.Add( self.m_panel74, 1, wx.EXPAND |wx.ALL, 5 )


        gSizer90.Add( gSizer92, 1, wx.EXPAND, 5 )


        sbSizer74.Add( gSizer90, 1, wx.EXPAND, 5 )


        self.m_panel70.SetSizer( sbSizer74 )
        self.m_panel70.Layout()
        sbSizer74.Fit( self.m_panel70 )
        sbSizer69.Add( self.m_panel70, 1, wx.EXPAND |wx.ALL, 5 )


        self.m_panel65.SetSizer( sbSizer69 )
        self.m_panel65.Layout()
        sbSizer69.Fit( self.m_panel65 )        
        self.m_notebook1.AddPage( self.m_panel65, u"Location", False )
        
#Contact        
        self.m_panel75 = wx.Panel( self.m_notebook1, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_panel75.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        sbSizer79 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel75, wx.ID_ANY, u"Contact" ), wx.VERTICAL )

        self.m_panel76 = wx.Panel( sbSizer79.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer80 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel76, wx.ID_ANY, u"Tel number" ), wx.VERTICAL )

        gSizer93 = wx.GridSizer( 0, 2, 0, 0 )

        gSizer94 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel77 = wx.Panel( sbSizer80.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer81 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel77, wx.ID_ANY, u"Hyphen included" ), wx.VERTICAL )

        self.m_textCtrl33 = wx.TextCtrl( sbSizer81.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer81.Add( self.m_textCtrl33, 0, wx.ALL, 5 )


        self.m_panel77.SetSizer( sbSizer81 )
        self.m_panel77.Layout()
        sbSizer81.Fit( self.m_panel77 )
        gSizer94.Add( self.m_panel77, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel78 = wx.Panel( sbSizer80.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer82 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel78, wx.ID_ANY, u"Num1" ), wx.VERTICAL )

        self.m_textCtrl34 = wx.TextCtrl( sbSizer82.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer82.Add( self.m_textCtrl34, 0, wx.ALL, 5 )


        self.m_panel78.SetSizer( sbSizer82 )
        self.m_panel78.Layout()
        sbSizer82.Fit( self.m_panel78 )
        gSizer94.Add( self.m_panel78, 1, wx.EXPAND |wx.ALL, 5 )


        gSizer93.Add( gSizer94, 1, wx.EXPAND, 5 )

        gSizer95 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel79 = wx.Panel( sbSizer80.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer83 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel79, wx.ID_ANY, u"Num2" ), wx.VERTICAL )

        self.m_textCtrl35 = wx.TextCtrl( sbSizer83.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer83.Add( self.m_textCtrl35, 0, wx.ALL, 5 )


        self.m_panel79.SetSizer( sbSizer83 )
        self.m_panel79.Layout()
        sbSizer83.Fit( self.m_panel79 )
        gSizer95.Add( self.m_panel79, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel80 = wx.Panel( sbSizer80.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer84 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel80, wx.ID_ANY, u"Num3" ), wx.VERTICAL )

        self.m_textCtrl36 = wx.TextCtrl( sbSizer84.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer84.Add( self.m_textCtrl36, 0, wx.ALL, 5 )


        self.m_panel80.SetSizer( sbSizer84 )
        self.m_panel80.Layout()
        sbSizer84.Fit( self.m_panel80 )
        gSizer95.Add( self.m_panel80, 1, wx.EXPAND |wx.ALL, 5 )


        gSizer93.Add( gSizer95, 1, wx.EXPAND, 5 )


        sbSizer80.Add( gSizer93, 1, wx.EXPAND, 5 )


        self.m_panel76.SetSizer( sbSizer80 )
        self.m_panel76.Layout()
        sbSizer80.Fit( self.m_panel76 )
        sbSizer79.Add( self.m_panel76, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel81 = wx.Panel( sbSizer79.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer85 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel81, wx.ID_ANY, u"Email address" ), wx.VERTICAL )

        gSizer96 = wx.GridSizer( 0, 2, 0, 0 )

        gSizer97 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel82 = wx.Panel( sbSizer85.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer86 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel82, wx.ID_ANY, u"At mark included" ), wx.VERTICAL )

        self.m_textCtrl37 = wx.TextCtrl( sbSizer86.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer86.Add( self.m_textCtrl37, 0, wx.ALL, 5 )


        self.m_panel82.SetSizer( sbSizer86 )
        self.m_panel82.Layout()
        sbSizer86.Fit( self.m_panel82 )
        gSizer97.Add( self.m_panel82, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel83 = wx.Panel( sbSizer85.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer87 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel83, wx.ID_ANY, u"Account name" ), wx.VERTICAL )

        self.m_textCtrl38 = wx.TextCtrl( sbSizer87.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer87.Add( self.m_textCtrl38, 0, wx.ALL, 5 )


        self.m_panel83.SetSizer( sbSizer87 )
        self.m_panel83.Layout()
        sbSizer87.Fit( self.m_panel83 )
        gSizer97.Add( self.m_panel83, 1, wx.EXPAND |wx.ALL, 5 )


        gSizer96.Add( gSizer97, 1, wx.EXPAND, 5 )

        gSizer98 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel84 = wx.Panel( sbSizer85.GetStaticBox(), wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        sbSizer88 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel84, wx.ID_ANY, u"Domain name" ), wx.VERTICAL )

        self.m_textCtrl39 = wx.TextCtrl( sbSizer88.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        sbSizer88.Add( self.m_textCtrl39, 0, wx.ALL, 5 )


        self.m_panel84.SetSizer( sbSizer88 )
        self.m_panel84.Layout()
        sbSizer88.Fit( self.m_panel84 )
        gSizer98.Add( self.m_panel84, 1, wx.EXPAND |wx.ALL, 5 )


        gSizer96.Add( gSizer98, 1, wx.EXPAND, 5 )


        sbSizer85.Add( gSizer96, 1, wx.EXPAND, 5 )


        self.m_panel81.SetSizer( sbSizer85 )
        self.m_panel81.Layout()
        sbSizer85.Fit( self.m_panel81 )
        sbSizer79.Add( self.m_panel81, 1, wx.EXPAND |wx.ALL, 5 )


        self.m_panel75.SetSizer( sbSizer79 )
        self.m_panel75.Layout()
        sbSizer79.Fit( self.m_panel75 )
        self.m_notebook1.AddPage( self.m_panel75, u"Contact", True )

        hbox4.Add( self.m_notebook1, 1, wx.EXPAND |wx.ALL, 5 )

        self.btn11 = wx.Button( self, wx.ID_ANY, u"Save", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.btn11.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        hbox4.Add( self.btn11, 0, wx.ALL, 5 )


        self.SetSizer( hbox4 )
        self.Layout()

        self.Centre( wx.BOTH )

# Connect Events
        self.btn11.Bind( wx.EVT_BUTTON, self.write )
        self.Bind( wx.EVT_CLOSE, self.quit_button )

#設定情報（json）読み込み
#文字コードをUTF-8に変換しないとエラーが発生するため注意！！
        with codecs.open('profile.json','r',encoding='utf-8') as f:
            j = json.load(f,strict=False)
#            print(j)
            f.close()
            self.m_textCtrl11.SetValue(j['companyname'])
            self.m_textCtrl12.SetValue(j['companyhiragana'])
            self.m_textCtrl13.SetValue(j['companykatakana'])
            self.m_comboBox61.SetValue(j['industry'])
            self.m_textCtrl14.SetValue(j['businesscontent'])
            self.m_textCtrl15.SetValue(j['kanjifull'])
            self.m_textCtrl16.SetValue(j['kanjisei'])
            self.m_textCtrl17.SetValue(j['kanjimei'])
            self.m_textCtrl18.SetValue(j['hiraganafull'])
            self.m_textCtrl19.SetValue(j['hiraganasei'])
            self.m_textCtrl20.SetValue(j['hiraganamei'])
            self.m_textCtrl21.SetValue(j['katakanafull'])
            self.m_textCtrl22.SetValue(j['katakanasei'])
            self.m_textCtrl23.SetValue(j['katakanamei'])
            self.m_textCtrl24.SetValue(j['department'])
            self.m_textCtrl25.SetValue(j['position'])
            self.m_textCtrl26.SetValue(j['age'])
            self.m_textCtrl27.SetValue(j['postcodefull'])
            self.m_textCtrl28.SetValue(j['postcode1'])
            self.m_textCtrl29.SetValue(j['postcode2'])
            self.m_comboBox6.SetValue(j['prefecture'])
            self.m_textCtrl30.SetValue(j['municipalities'])
            self.m_textCtrl31.SetValue(j['address'])
            self.m_textCtrl32.SetValue(j['building'])
            self.m_textCtrl33.SetValue(j['telnumberfull'])
            self.m_textCtrl34.SetValue(j['tel1'])
            self.m_textCtrl35.SetValue(j['tel2'])
            self.m_textCtrl36.SetValue(j['tel3'])
            self.m_textCtrl37.SetValue(j['email'])
            self.m_textCtrl38.SetValue(j['account'])
            self.m_textCtrl39.SetValue(j['domain'])

#設定情報（json）書き出し
    def write(self, event):
            if self.m_comboBox6.GetValue() == '選択して下さい' \
                or self.m_textCtrl11.GetValue() == '' \
                    or self.m_textCtrl12.GetValue() == '' \
                        or self.m_textCtrl13.GetValue() == '' \
                            or self.m_textCtrl14.GetValue() == '' \
                                or self.m_textCtrl15.GetValue() == '' \
                                    or self.m_textCtrl16.GetValue() == '' \
                                        or self.m_textCtrl17.GetValue() == '' \
                                            or self.m_textCtrl18.GetValue() == '' \
                                                or self.m_textCtrl19.GetValue() == '' \
                                                    or self.m_textCtrl20.GetValue() == '' \
                                                        or self.m_textCtrl21.GetValue() == '' \
                                                            or self.m_textCtrl22.GetValue() == '' \
                                                                or self.m_textCtrl23.GetValue() == '' \
                                                                    or self.m_textCtrl24.GetValue() == '' \
                                                                        or self.m_textCtrl25.GetValue() == '' \
                                                                            or self.m_textCtrl26.GetValue() == '' \
                                                                                or self.m_textCtrl27.GetValue() == '' \
                                                                                    or self.m_textCtrl28.GetValue() == '' \
                                                                                        or self.m_textCtrl29.GetValue() == '' \
                                                                                            or self.m_textCtrl30.GetValue() == '' \
                                                                                                or self.m_textCtrl31.GetValue() == '' \
                                                                                                    or self.m_textCtrl32.GetValue() == '' \
                                                                                                        or self.m_textCtrl33.GetValue() == '' \
                                                                                                            or self.m_textCtrl34.GetValue() == '' \
                                                                                                                or self.m_textCtrl35.GetValue() == '' \
                                                                                                                    or self.m_textCtrl36.GetValue() == '' \
                                                                                                                        or self.m_textCtrl37.GetValue() == '' \
                                                                                                                            or self.m_textCtrl38.GetValue() == '' \
                                                                                                                                or self.m_textCtrl39.GetValue() == '' \
                                                                                                                                    or self.m_comboBox61.GetValue() == '選択して下さい':
              self.m_comboBox6.SetBackgroundColour('#f56cbe')
              self.m_comboBox61.SetBackgroundColour('#f56cbe')
              self.m_textCtrl11.SetBackgroundColour('#f56cbe')
              self.m_textCtrl12.SetBackgroundColour('#f56cbe')
              self.m_textCtrl13.SetBackgroundColour('#f56cbe')
              self.m_textCtrl14.SetBackgroundColour('#f56cbe')
              self.m_textCtrl15.SetBackgroundColour('#f56cbe')
              self.m_textCtrl16.SetBackgroundColour('#f56cbe')
              self.m_textCtrl17.SetBackgroundColour('#f56cbe')
              self.m_textCtrl18.SetBackgroundColour('#f56cbe')
              self.m_textCtrl19.SetBackgroundColour('#f56cbe')
              self.m_textCtrl20.SetBackgroundColour('#f56cbe')
              self.m_textCtrl21.SetBackgroundColour('#f56cbe')
              self.m_textCtrl22.SetBackgroundColour('#f56cbe')
              self.m_textCtrl23.SetBackgroundColour('#f56cbe')
              self.m_textCtrl24.SetBackgroundColour('#f56cbe')
              self.m_textCtrl25.SetBackgroundColour('#f56cbe')
              self.m_textCtrl26.SetBackgroundColour('#f56cbe')
              self.m_textCtrl27.SetBackgroundColour('#f56cbe')
              self.m_textCtrl28.SetBackgroundColour('#f56cbe')
              self.m_textCtrl29.SetBackgroundColour('#f56cbe')
              self.m_textCtrl30.SetBackgroundColour('#f56cbe')
              self.m_textCtrl31.SetBackgroundColour('#f56cbe')
              self.m_textCtrl32.SetBackgroundColour('#f56cbe')
              self.m_textCtrl33.SetBackgroundColour('#f56cbe')
              self.m_textCtrl34.SetBackgroundColour('#f56cbe')
              self.m_textCtrl35.SetBackgroundColour('#f56cbe')
              self.m_textCtrl36.SetBackgroundColour('#f56cbe')
              self.m_textCtrl37.SetBackgroundColour('#f56cbe')
              self.m_textCtrl38.SetBackgroundColour('#f56cbe')
              self.m_textCtrl39.SetBackgroundColour('#f56cbe')
              wx.MessageBox(u'There are unselected or blank areas!!', u'Setting value error', wx.ICON_ERROR)
            else:
              self.m_comboBox6.SetBackgroundColour('#FFFFFF')
              self.m_comboBox61.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl11.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl12.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl13.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl14.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl15.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl16.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl17.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl18.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl19.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl20.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl21.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl22.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl23.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl24.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl25.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl26.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl27.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl28.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl29.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl30.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl31.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl32.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl33.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl34.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl35.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl36.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl37.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl38.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl39.SetBackgroundColour('#FFFFFF')

#文字コードをUTF-8に変換しないとエラー発生がするため注意！！
              with open('profile.json','w',encoding='utf-8') as f:
                w_data = {}
                w_data['prefecture'] = self.m_comboBox6.GetValue()
                w_data['industry'] = self.m_comboBox61.GetValue()
                w_data['companyname'] = self.m_textCtrl11.GetValue()
                w_data['companyhiragana'] = self.m_textCtrl12.GetValue()
                w_data['companykatakana'] = self.m_textCtrl13.GetValue()
                w_data['businesscontent'] = self.m_textCtrl14.GetValue()
                w_data['kanjifull'] = self.m_textCtrl15.GetValue()
                w_data['kanjisei'] = self.m_textCtrl16.GetValue()
                w_data['kanjimei'] = self.m_textCtrl17.GetValue()
                w_data['hiraganafull'] = self.m_textCtrl18.GetValue()
                w_data['hiraganasei'] = self.m_textCtrl19.GetValue()
                w_data['hiraganamei'] = self.m_textCtrl20.GetValue()
                w_data['katakanafull'] = self.m_textCtrl21.GetValue()
                w_data['katakanasei'] = self.m_textCtrl22.GetValue()
                w_data['katakanamei'] = self.m_textCtrl23.GetValue()
                w_data['department'] = self.m_textCtrl24.GetValue()
                w_data['position'] = self.m_textCtrl25.GetValue()
                w_data['age'] = self.m_textCtrl26.GetValue()
                w_data['postcodefull'] = self.m_textCtrl27.GetValue()
                w_data['postcode1'] = self.m_textCtrl28.GetValue()
                w_data['postcode2'] = self.m_textCtrl29.GetValue()
                w_data['municipalities'] = self.m_textCtrl30.GetValue()
                w_data['address'] = self.m_textCtrl31.GetValue()
                w_data['building'] = self.m_textCtrl32.GetValue()
                w_data['telnumberfull'] = self.m_textCtrl33.GetValue()
                w_data['tel1'] = self.m_textCtrl34.GetValue()
                w_data['tel2'] = self.m_textCtrl35.GetValue()
                w_data['tel3'] = self.m_textCtrl36.GetValue()
                w_data['email'] = self.m_textCtrl37.GetValue()
                w_data['account'] = self.m_textCtrl38.GetValue()
                w_data['domain'] = self.m_textCtrl39.GetValue()

                json.dump(w_data, f, ensure_ascii=False, indent=1, sort_keys=True, separators=(',', ': '))
                print('WRITE:')
 #               print(w_data)
                self.Destroy()

# TODO: Implement quit_button
    def quit_button( self, event ):
        self.Destroy()

#Email_body_creation        
class MyProject1MyDialog5( app.MyDialog5 ):
    def __init__(self, parent):
        app.MyDialog5.__init__(self, parent)
        self.parent = parent

        hbox4 = wx.BoxSizer( wx.VERTICAL )

        self.m_panel22 = wx.Panel( self, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_panel22.SetFont( wx.Font( 10, wx.FONTFAMILY_MODERN, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        sbSizer17 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel22, wx.ID_ANY, u"Tittle" ), wx.VERTICAL )

        self.m_textCtrl6 = wx.TextCtrl( sbSizer17.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        self.m_textCtrl6.SetMaxLength(100)
        sbSizer17.Add( self.m_textCtrl6, 0, wx.ALL, 5 )


        self.m_panel22.SetSizer( sbSizer17 )
        self.m_panel22.Layout()
        sbSizer17.Fit( self.m_panel22 )
        hbox4.Add( self.m_panel22, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel23 = wx.Panel( self, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_panel23.SetFont( wx.Font( 10, wx.FONTFAMILY_MODERN, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        sbSizer18 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel23, wx.ID_ANY, u"Url" ), wx.VERTICAL )

        self.m_textCtrl7 = wx.TextCtrl( sbSizer18.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,-1 ), 0 )
        self.m_textCtrl7.SetMaxLength(100)
        sbSizer18.Add( self.m_textCtrl7, 0, wx.ALL, 5 )


        self.m_panel23.SetSizer( sbSizer18 )
        self.m_panel23.Layout()
        sbSizer18.Fit( self.m_panel23 )
        hbox4.Add( self.m_panel23, 1, wx.EXPAND |wx.ALL, 5 )

        gSizer89 = wx.GridSizer( 0, 2, 0, 0 )

        self.m_panel24 = wx.Panel( self, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_panel24.SetFont( wx.Font( 10, wx.FONTFAMILY_MODERN, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        sbSizer19 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel24, wx.ID_ANY, u"Normal transmission" ), wx.VERTICAL )

        self.m_textCtrl8 = wx.TextCtrl( sbSizer19.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,200 ), wx.TE_MULTILINE )
#        self.m_textCtrl8.SetMaxLength(2000)
        sbSizer19.Add( self.m_textCtrl8, 0, wx.ALL, 5 )


        self.m_panel24.SetSizer( sbSizer19 )
        self.m_panel24.Layout()
        sbSizer19.Fit( self.m_panel24 )
        gSizer89.Add( self.m_panel24, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel25 = wx.Panel( self, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_panel25.SetFont( wx.Font( 10, wx.FONTFAMILY_MODERN, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        sbSizer20 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel25, wx.ID_ANY, u"Within 1000 characters" ), wx.VERTICAL )

        self.m_textCtrl9 = wx.TextCtrl( sbSizer20.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,200 ), wx.TE_MULTILINE )
        self.m_textCtrl9.SetMaxLength(1000)
        sbSizer20.Add( self.m_textCtrl9, 0, wx.ALL, 5 )


        self.m_panel25.SetSizer( sbSizer20 )
        self.m_panel25.Layout()
        sbSizer20.Fit( self.m_panel25 )
        gSizer89.Add( self.m_panel25, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel241 = wx.Panel( self, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_panel241.SetFont( wx.Font( 10, wx.FONTFAMILY_MODERN, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        sbSizer191 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel241, wx.ID_ANY, u"Within 500 characters" ), wx.VERTICAL )

        self.m_textCtrl10 = wx.TextCtrl( sbSizer191.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,200 ), wx.TE_MULTILINE )
        self.m_textCtrl10.SetMaxLength(500)
        sbSizer191.Add( self.m_textCtrl10, 0, wx.ALL, 5 )


        self.m_panel241.SetSizer( sbSizer191 )
        self.m_panel241.Layout()
        sbSizer191.Fit( self.m_panel241 )
        gSizer89.Add( self.m_panel241, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel242 = wx.Panel( self, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_panel242.SetFont( wx.Font( 10, wx.FONTFAMILY_MODERN, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        sbSizer192 = wx.StaticBoxSizer( wx.StaticBox( self.m_panel242, wx.ID_ANY, u"Other" ), wx.VERTICAL )

        self.m_textCtrl11 = wx.TextCtrl( sbSizer192.GetStaticBox(), wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.Size( 400,200 ), wx.TE_MULTILINE )
        self.m_textCtrl11.SetMaxLength(300)
        self.m_textCtrl11.Disable()
        sbSizer192.Add( self.m_textCtrl11, 0, wx.ALL, 5 )


        self.m_panel242.SetSizer( sbSizer192 )
        self.m_panel242.Layout()
        sbSizer192.Fit( self.m_panel242 )
        gSizer89.Add( self.m_panel242, 1, wx.EXPAND |wx.ALL, 5 )


        hbox4.Add( gSizer89, 1, wx.EXPAND, 5 )

        self.btn11 = wx.Button( self, wx.ID_ANY, u"Save", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.btn11.SetFont( wx.Font( 10, wx.FONTFAMILY_DEFAULT, wx.FONTSTYLE_NORMAL, wx.FONTWEIGHT_NORMAL, False, "Meiryo UI" ) )

        hbox4.Add( self.btn11, 0, wx.ALL, 5 )


        self.SetSizer( hbox4 )
        self.Layout()

        self.Centre( wx.BOTH )

# Connect Events
        self.btn11.Bind( wx.EVT_BUTTON, self.write )
        self.Bind( wx.EVT_CLOSE, self.quit_button )

#設定情報（json）読み込み
#文字コードをUTF-8に変換しないとエラーが発生するため注意！！
        with codecs.open('textarea.json','r',encoding='utf-8') as f:
            j = json.load(f,strict=False)
#            print(j)
            f.close()
            self.m_textCtrl6.SetValue(j['title'])
            self.m_textCtrl7.SetValue(j['url'])
            self.m_textCtrl8.SetValue(j['body1'])
            self.m_textCtrl9.SetValue(j['body2'])
            self.m_textCtrl10.SetValue(j['body3'])
            self.m_textCtrl11.SetValue(j['body4'])

#設定情報（json）書き出し
    def write(self, event):
            if self.m_textCtrl6.GetValue() == '' \
                    or self.m_textCtrl7.GetValue() == '' \
                        or self.m_textCtrl8.GetValue() == '' \
                            or self.m_textCtrl9.GetValue() == '' \
                                or self.m_textCtrl10.GetValue() == '' \
                                    or self.m_textCtrl11.GetValue() == '':
              self.m_textCtrl6.SetBackgroundColour('#f56cbe')
              self.m_textCtrl7.SetBackgroundColour('#f56cbe')
              self.m_textCtrl8.SetBackgroundColour('#f56cbe')
              self.m_textCtrl9.SetBackgroundColour('#f56cbe')
              self.m_textCtrl10.SetBackgroundColour('#f56cbe')
              self.m_textCtrl11.SetBackgroundColour('#f56cbe')
              wx.MessageBox(u'There are unselected or blank areas!!', u'Setting value error', wx.ICON_ERROR)
            elif "http" in self.m_textCtrl8.GetValue() \
                or "http" in self.m_textCtrl9.GetValue() \
                    or "http" in self.m_textCtrl10.GetValue() \
                        or "http" in self.m_textCtrl11.GetValue():
              self.m_textCtrl8.SetBackgroundColour('#f56cbe')
              self.m_textCtrl9.SetBackgroundColour('#f56cbe')
              self.m_textCtrl10.SetBackgroundColour('#f56cbe')
              self.m_textCtrl11.SetBackgroundColour('#f56cbe')
              wx.MessageBox(u'You cannot include the url in the body of the transmission!!', u'Setting value error', wx.ICON_ERROR)
            else:
              self.m_textCtrl6.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl7.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl8.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl9.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl10.SetBackgroundColour('#FFFFFF')
              self.m_textCtrl11.SetBackgroundColour('#FFFFFF')

#文字コードをUTF-8に変換しないとエラー発生がするため注意！！
              with open('textarea.json','w',encoding='utf-8') as f:
                w_data = {}
                w_data['title'] = self.m_textCtrl6.GetValue()
                w_data['url'] = self.m_textCtrl7.GetValue()
                w_data['body1'] = self.m_textCtrl8.GetValue()
                w_data['body2'] = self.m_textCtrl9.GetValue()
                w_data['body3'] = self.m_textCtrl10.GetValue()
                w_data['body4'] = self.m_textCtrl11.GetValue()

                json.dump(w_data, f, ensure_ascii=False, indent=1, sort_keys=True, separators=(',', ': '))
                print('WRITE:')
 #               print(w_data)
                self.Destroy()

# TODO: Implement quit_button
    def quit_button( self, event ):
        self.Destroy()

#page_index                     
class MyProject1MyFrame4( app.MyFrame4 ):
	def __init__( self, parent ):
		app.MyFrame4.__init__( self, parent )
		self.InitializeComponents()

	def InitializeComponents(self):
#		wb = gc.open_by_key(key)
#		ws2 = wb.worksheet(title)
#		lastrow = len(ws2.col_values(1))
		self.grid = wx.grid.Grid( self, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, 0 )        
#		grid = wx.grid.Grid(self)
		self.grid.CreateGrid(1000, 1)

		# Set column labels.
		self.grid.SetColLabelValue(0, "ページURL")
        
		main_sizer = wx.BoxSizer(wx.VERTICAL)
		main_sizer.Add(self.grid, 0, wx.EXPAND)
#		main_sizer.Add(bsizer, 1, wx.EXPAND | wx.TOP, 5)
		self.SetSizer(main_sizer)
        
		self.tableShow()
        
	def tableShow(self):
		self.grid.AutoSize()


class MyProject1MyFrame5( app.MyFrame5 ):
	def __init__( self, parent ):
		app.MyFrame5.__init__( self, parent )
		self.InitializeComponents()

	def InitializeComponents(self):
#		wb = gc.open_by_key(key)
#		ws3 = wb.worksheet(title)        
#		lastrow = len(ws3.col_values(1))        
		self.grid = wx.grid.Grid( self, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, 0 )        
#		grid = wx.grid.Grid(self)
		self.grid.CreateGrid(10000, 6)
		self.grid.EnableEditing( True )

		# Set column labels.
		self.grid.SetColLabelValue(0, "リスト元リンク")        
		self.grid.SetColLabelValue(1, "法人名称")
		self.grid.SetColLabelValue(2, "住所")
		self.grid.SetColLabelValue(3, "電話番号")
		self.grid.SetColLabelValue(4, "ホームページ")
		self.grid.SetColLabelValue(5, "お問い合わせ")        
        
		main_sizer = wx.BoxSizer(wx.VERTICAL)
		main_sizer.Add(self.grid, 0, wx.EXPAND)
#		main_sizer.Add(bsizer, 1, wx.EXPAND | wx.TOP, 5)
		self.SetSizer(main_sizer)
        
		self.tableShow()
        
	def tableShow(self):
		self.grid.AutoSize()
